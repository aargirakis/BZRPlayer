	******************************************************
	****  Marble Madness Aerial Race - Custom Module  ****
	****        all adaptions by Wanted Team	  ****
	******************************************************

	incdir	"dh2:include/"
	include 'misc/eagleplayer2.01.i'

	SECTION Player,Code_C

MM_Start
	PLAYERHEADER PlayerTagArray

	dc.b	"$VER: Marble Madness 'Aerial Race Music' - Custom Module,",10
	dc.b	'adapted by Don Adan/Wanted Team',0
	even

PlayerTagArray
	dc.l	DTP_CustomPlayer,1
	dc.l	DTP_PlayerName,PlayerName
	dc.l	DTP_Interrupt,Interrupt
	dc.l	DTP_InitPlayer,InitPlayer
	dc.l	DTP_EndPlayer,EndPlayer
	dc.l	DTP_InitSound,InitSound
	dc.l	DTP_EndSound,EndSound
	dc.l	DTP_SubSongRange,SubSongRange
	dc.l	EP_Get_ModuleInfo,Get_ModuleInfo
	dc.l	TAG_DONE
PlayerName
	dc.b	"CustomPlay",0
Text
	dc.b	10
	dc.b	"             MARBLE MADNESS",10
	dc.b	10
	dc.b	"            AMIGA VERSION BY",10
	dc.b	"               LARRY REED",10
	dc.b	10
	dc.b	"     (C) 1984-86 BY ATARI GAMES CORP.",10
	dc.b	"           AND ELECTRONIC ARTS",0
	even

Timer
	dc.w	0

***************************************************************************
***************************** DTP_SubSongRange ****************************
***************************************************************************

SubSongRange
	moveq	#0,D0
	moveq	#2,D1
	rts

***************************************************************************
***************************** EP_Get_ModuleInfo ***************************
***************************************************************************

Get_ModuleInfo
	lea	InfoBuffer(PC),A0
	rts

InfoBuffer
	dc.l	MI_SpecialInfo,Text
	dc.l	MI_LoadSize,MM_End-MM_Start
	dc.l	0

***************************************************************************
***************************** DTP_InitPlayer ******************************
***************************************************************************

InitPlayer
	move.l	4.W,execBase
	bsr.w	InitPlay
	moveq	#0,D0
	rts

***************************************************************************
***************************** DTP_EndPlayer *******************************
***************************************************************************

EndPlayer
	bsr.w	EndPlay
	moveq	#0,D0
	rts

***************************************************************************
***************************** DTP_Intterrupt ******************************
***************************************************************************

Interrupt
	movem.l	D1-A6,-(SP)

	bsr.w	INT_Play

	movem.l	(SP)+,D1-A6
	moveq	#0,D0
	rts

***************************************************************************
***************************** DTP_InitSound *******************************
***************************************************************************

InitSound
	move.w	Timer(PC),D0
	bne.b	Done
	move.w	dtg_Timer(A5),D0
	mulu.w	#5,D0
	divu.w	#6,D0			; 60 Hz
	lea	Timer(PC),A0
	move.w	D0,(A0)
Done	move.w	D0,dtg_Timer(A5)
	move.w	dtg_SndNum(A5),D1
	moveq	#0,D0
	move.b	SongNumber(PC,D1.W),D0
	clr.l	-(SP)
	move.l	D0,-(SP)
	bsr.w	InitMusic
	addq.l	#8,SP
	rts

SongNumber
	dc.b	25
	dc.b	30
	dc.b	31
	dc.b	0

***************************************************************************
***************************** DTP_EndSound ********************************
***************************************************************************

EndSound
	rts

***************************************************************************
***************************************************************************
***************************************************************************

; Music from "Marble Madness" (c) 1986 by Electronic Arts

;	SECTION	MarbleMadness01EE28,CODE
lbC01EE28	LINK.W	A6,#-2
	MOVEM.L	D7,-(SP)
	MOVE.W	10(A6),D7
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9A2,A0
	CMPI.L	#$FFFFFFFF,(A0)
	BNE.S	lbC01EE54
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC01EE54	MOVE.L	D7,D0
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9A2,A0
	MOVE.L	(A0),-(SP)
	JSR	lbC020ECE_PutMsg
	ADDQ.L	#4,SP
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9A2,A0
	MOVEQ	#-1,D1
	MOVE.L	D1,(A0)
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC01EE8A	LINK.W	A6,#-$1A
	MOVEM.L	D2/D3/D6/D7/A2-A5,-(SP)
	MOVE.B	15(A6),D6
	EXT.W	D6
	MOVEQ	#-1,D7
lbC01EE9A	ADDQ.W	#1,D7
	SUBI.W	#12,D6
	BGE.S	lbC01EE9A
	MOVE.L	D7,D0
	ADDI.W	#12,D6
	MOVE.W	10(A6),D7
	MOVE.L	D7,D1
	MOVE.L	D7,D2
	EXT.L	D2
	ASL.L	#4,D2
	MOVEA.L	D2,A0
	ADDA.L	#lbL01F91A,A0
	MOVEA.L	A0,A5
	MOVEA.L	(A5),A0
	MOVEA.L	10(A0),A4
	MOVE.W	D0,-$12(A6)
	ANDI.L	#$FFFF,D0
	MOVEQ	#0,D2
	MOVE.B	12(A5),D2
	CMP.L	D2,D0
	BLS.S	lbC01EEE0
	ANDI.W	#$FF,D2
	MOVE.W	D2,-$12(A6)
lbC01EEE0	MOVEQ	#0,D0
	MOVE.W	-$12(A6),D0
	MOVEQ	#0,D1
	MOVE.B	13(A5),D1
	CMP.L	D1,D0
	SCS	D2
	NEG.B	D2
	EXT.W	D2
	EXT.L	D2
	MOVE.W	D2,10(A6)
	TST.W	D2
	BEQ.S	lbC01EF06
	ANDI.W	#$FF,D1
	MOVE.W	D1,-$12(A6)
lbC01EF06	MOVEQ	#0,D0
	MOVE.W	-$12(A6),D0
	MOVEQ	#8,D1
	SUB.L	D0,D1
	MOVEQ	#0,D2
	MOVE.W	8(A5),D2
	ASL.L	D1,D2
	MOVE.L	D2,(A4)
	ASL.L	#1,D2
	MOVEA.L	4(A5),A0
	ADDA.L	D2,A0
	MOVE.L	A0,8(A4)
	MOVE.L	D6,D1
	MOVE.L	D6,D2
	EXT.L	D2
	ASL.L	#1,D2
	MOVEA.L	D2,A1
	ADDA.L	#lbL01F902,A1
	MOVE.W	(A1),D2
	MOVE.W	10(A6),D3
	ASL.W	D3,D2
	MOVE.W	D2,4(A4)
	MOVE.L	D7,D3
	EXT.L	D3
	MOVEA.L	D3,A0
	ADDA.L	#lbL01F99A,A0
	MOVE.B	(A0),D3
	ANDI.W	#$FF,D3
	MOVE.W	D3,6(A4)
	MOVEA.L	(A5),A0
	TST.L	(A0)
	BEQ.S	lbC01EF8E
	MOVEA.L	(A0),A1
	MOVEA.L	10(A1),A3
	MOVEQ	#8,D2
	SUB.L	D0,D2
	MOVEQ	#0,D0
	MOVE.W	10(A5),D0
	ASL.L	D2,D0
	MOVE.L	D0,(A3)
	MOVE.L	(A4),D2
	SUB.L	D0,D2
	ASL.L	#1,D2
	MOVEA.L	8(A4),A0
	ADDA.L	D2,A0
	MOVE.L	A0,8(A3)
	MOVE.W	4(A4),4(A3)
	MOVE.W	6(A4),6(A3)
lbC01EF8E	TST.B	15(A5)
	BNE.S	lbC01EF9E
	MOVE.B	14(A5),D0
	CMP.B	15(A6),D0
	BEQ.S	lbC01F00C
lbC01EF9E	MOVE.L	D7,D0
	EXT.L	D0
	MOVE.L	D0,-(SP)
	BSR.L	lbC01EE28
	ADDQ.L	#4,SP
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9A2,A0
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A1
	ADDA.L	#lbL01FE82,A1
	MOVE.L	D7,D1
	EXT.L	D1
	ASL.L	#2,D1
	MOVEA.L	D1,A2
	ADDA.L	#lbL01FEA2,A2
	MOVE.L	A0,$24(SP)
	MOVEA.L	$10(A6),A0
	MOVE.B	6(A0),D1
	EXT.W	D1
	EXT.L	D1
	MOVE.W	4(A0),D2
	EXT.L	D2
	MOVE.L	D2,-(SP)
	MOVE.L	D1,-(SP)
	MOVE.L	#$FFFF,-(SP)
	MOVE.L	(A2),-(SP)
	MOVE.L	(A1),-(SP)
	MOVE.L	(A5),-(SP)
	JSR	StartSfx
	LEA	$18(SP),SP
	MOVEA.L	$24(SP),A0
	MOVE.L	D0,(A0)
lbC01F00C	MOVE.B	15(A6),14(A5)
	MOVE.L	D7,D0
	EXT.L	D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9C2,A0
	MOVE.B	(A0),D0
	ANDI.B	#$40,D0
	MOVE.B	D0,15(A5)
	MOVEM.L	(SP)+,D2/D3/D6/D7/A2-A5
	UNLK	A6
	RTS

lbC01F030	LINK.W	A6,#-2
	CLR.W	-2(A6)
lbC01F038	MOVE.W	-2(A6),D0
	CMPI.W	#8,D0
	BGE.S	lbC01F052
	EXT.L	D0
	MOVE.L	D0,-(SP)
	BSR.L	lbC01EE28
	ADDQ.L	#4,SP
	ADDQ.W	#1,-2(A6)
	BRA.S	lbC01F038

lbC01F052	UNLK	A6
	RTS

lbC01F056	LINK.W	A6,#0
	MOVEM.L	A2,-(SP)
	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9FA,A0
	MOVEQ	#0,D0
	MOVE.W	D0,(A0)
	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FA0A,A0
	MOVE.W	(A0),D0
	SUBQ.W	#1,D0
	MOVE.W	D0,(A0)
	TST.W	D0
	BLE.S	lbC01F094
	MOVEM.L	(SP)+,A2
	UNLK	A6
	RTS

lbC01F094	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9EA,A0
	MOVE.W	(A0),D1
	ADDQ.W	#1,D1
	MOVE.W	D1,(A0)
	MOVE.W	10(A6),D1
	EXT.L	D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01FA0A,A0
	MOVEA.L	D0,A1
	ADDA.L	#lbL01F9EA,A1
	MOVE.W	(A1),D0
	MULS.W	#6,D0
	MOVEA.L	12(A6),A2
	MOVEA.L	(A2),A1
	ADDA.L	D0,A1
	MOVE.W	(A1),(A0)
	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FA0A,A0
	MOVE.W	(A0),D0
	TST.W	D0
	BNE.S	lbC01F15A
	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9EA,A0
	MOVEQ	#0,D0
	MOVE.W	D0,(A0)
	MOVE.W	10(A6),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FA0A,A0
	MOVEA.L	(A2),A1
	MOVE.W	(A1),(A0)
	TST.W	10(A6)
	BNE.S	lbC01F15A
	SUBQ.W	#1,lbW01FA1E
	TST.W	lbW01FA1E
	BGT.S	lbC01F15A
	MOVE.B	#1,lbB01F8FE
	BSR.L	lbC01F030
	MOVE.W	#1,musicDone
	MOVE.B	lbB01FA24,D0
	EXT.W	D0
	EXT.L	D0
	TST.L	D0
	BLE.S	lbC01F15A
	MOVEQ	#1,D1
	ASL.L	D0,D1
	MOVE.L	D1,-(SP)
	MOVE.L	lbL01FA20,-(SP)
	JSR	_Signal
	ADDQ.L	#8,SP
lbC01F15A	MOVEM.L	(SP)+,A2
	UNLK	A6
	RTS

play_sub1_maybe	
	LINK.W	A6,#-$14
	MOVEM.L	D2/D6/D7/A2,-(SP)
	MOVE.W	10(A6),D7
	EXT.L	D7
lbC01F170	
	TST.W	musicDone
	BNE.L	lbC01F250
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9EA,A0
	MOVE.W	(A0),D2
	MULS.W	#6,D2
	MOVEA.L	12(A6),A1
	MOVEA.L	(A1),A0
	ADDA.L	D2,A0
	MOVEA.L	D1,A2
	ADDA.L	#lbL01F9FA,A2
	MOVE.W	(A2),D1
	MOVE.W	D1,$1C(SP)
	ADDQ.W	#1,D1
	MOVE.W	D1,(A2)
	MOVE.W	$1C(SP),D1
	EXT.L	D1
	MOVEA.L	2(A0),A2
	ADDA.L	D1,A2
	MOVE.B	(A2),D6
	MOVE.L	D6,D1
	BTST	#7,D1
	BEQ.S	lbC01F1E0
	MOVE.L	D6,D1
	ANDI.B	#15,D1
	TST.B	D1
	BNE.S	lbC01F1D4
	MOVE.L	A1,-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	lbC01F056
	ADDQ.L	#8,SP
	BRA.S	lbC01F170

lbC01F1D4	MOVEA.L	D7,A0
	ADDA.L	#lbL01F9C2,A0
	MOVE.B	D6,(A0)
	BRA.S	lbC01F170

lbC01F1E0	MOVE.L	D7,D0
	MOVE.L	D7,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL01F9CA,A0
	MOVEA.L	D0,A1
	ADDA.L	#lbL01F9C2,A1
	MOVE.B	(A1),D1
	EXT.W	D1
	EXT.L	D1
	ANDI.L	#15,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A1
	ADDA.L	#lbL01FA26,A1
	MOVE.L	(A1),D1
	ADD.L	D1,(A0)
	CMPI.B	#$7F,D6
	BEQ.S	lbC01F250
	MOVE.B	lbB01FA25,D0
	ADD.B	D6,D0
	MOVE.L	D0,D6
	BLT.S	lbC01F248
	CMPI.B	#$6C,D6
	BGE.S	lbC01F248
	TST.W	lbW01F8FC
	BEQ.S	lbC01F248
	MOVE.L	D6,D0
	EXT.W	D0
	EXT.L	D0
	MOVE.L	12(A6),-(SP)
	MOVE.L	D0,-(SP)
	MOVE.L	D7,-(SP)
	BSR.L	lbC01EE8A
	LEA	12(SP),SP
	NOP
lbC01F248	MOVEM.L	(SP)+,D2/D6/D7/A2
	UNLK	A6
	RTS

lbC01F250	MOVE.L	D7,-(SP)
	BSR.L	lbC01EE28
	ADDQ.L	#4,SP
	MOVEM.L	(SP)+,D2/D6/D7/A2
	UNLK	A6
	RTS

	
	*-------------------------------------------------------------------------
	the "INT handler" just counts up the jiffyClock and then signals..
	
INT_Play
lbC01F260	ADDQ.L	#1,jiffyClock
	MOVE.W	signalFromIntHandler,D0
	EXT.L	D0
	MOVEQ	#1,D1
	ASL.L	D0,D1
	MOVE.L	D1,-(SP)
	MOVE.L	lbL01FADE,-(SP)
	JSR	_Signal					=> drive the handling in Task2's loop
	ADDQ.L	#8,SP
	MOVEQ	#0,D0
	RTS

playerRoutine	
	LINK.W	A6,#-14
	MOVEM.L	D6/D7/A4/A5,-(SP)
	MOVE.L	lbL01FA68,D6
	LEA	lbL01F9CA,A5
	MOVEA.L	lbL01FA1A,A4
	MOVEQ	#0,D7
	SUBQ.L	#8,A4
lbC01F2A4	
	ADDQ.L	#8,A4
	TST.L	(A4)
	BEQ.S	lbC01F2E4
	TST.L	(A5)
	BGT.S	lbC01F2BE
	MOVE.L	D7,D0
	EXT.L	D0
	MOVE.L	A4,-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	play_sub1_maybe
	ADDQ.L	#8,SP
	BRA.S	lbC01F2E4

lbC01F2BE	
	MOVE.L	(A5),D0
	CMP.L	D6,D0
	BGT.S	lbC01F2E4
	MOVE.L	D7,D0
	EXT.L	D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9C2,A0
	MOVE.B	(A0),D0
	BTST	#6,D0
	BEQ.S	lbC01F2E4
	MOVE.L	D7,D0
	EXT.L	D0
	MOVE.L	D0,-(SP)
	BSR.L	lbC01EE28
	ADDQ.L	#4,SP
lbC01F2E4	
	MOVEA.L	A5,A0
	ADDQ.L	#4,A5
	SUB.L	D6,(A0)
	ADDQ.W	#1,D7
	CMPI.W	#8,D7
	BLT.S	lbC01F2A4
	MOVEM.L	(SP)+,D6/D7/A4/A5
	UNLK	A6
	RTS

runTask2_lbC01F2FA	
	LINK.W	A6,#-8
	MOVEQ	#-1,D0
	MOVE.L	D0,-(SP)
	JSR	_AllocSignal
	ADDQ.L	#4,SP
	MOVE.L	jiffyClock,-8(A6)					>>>> basis für Zeitmessung
	MOVE.W	D0,signalFromIntHandler
	
	
task2_loop	
	MOVE.W	signalFromIntHandler,D0
	EXT.L	D0
	MOVEQ	#1,D1
	ASL.L	D0,D1
	MOVE.L	D1,-(SP)
	JSR	_Wait				=> wait for signal from INT-handler	
	ADDQ.L	#4,SP
	
	MOVE.B	#1,lbB01F8FF
	TST.B	lbB01F8FE
	BNE.S	lbC01F38A
	MOVE.L	-8(A6),D0
	MOVE.L	jiffyClock,D1		=> updated by INT-handler
	MOVE.L	D1,-8(A6)
	SUB.L	D0,D1
	MOVE.L	D1,-4(A6)				=> aktuelle Zeit in jiffies... 0-5
	CMPI.L	#5,D1			
	BLE.S	lbC01F362
	MOVEQ	#5,D0
	MOVE.L	D0,-4(A6)
	BRA.S	lbC01F378

lbC01F362	
	MOVE.W	maxDelay,D0
	EXT.L	D0
	MOVE.L	-4(A6),D1		>>> 0-5
	CMP.L	D0,D1
	BLE.S	lbC01F378
	MOVE.W	D1,maxDelay
	
	
lbC01F378	
	MOVE.L	-4(A6),D0
	SUBQ.L	#1,-4(A6)				<<<<< DIFFERENT
	TST.L	D0
	BEQ.S	lbC01F38A			
	BSR.L	playerRoutine
	BRA.S	lbC01F378

lbC01F38A	
	CLR.B	lbB01F8FF
	BRA.S	task2_loop

	
	
	
	
lbC01F392	MOVE.B	#1,lbB01F8FE

lbC01F39A	TST.B	lbB01F8FF
	BNE.S	lbC01F39A			>>>>>> where is lbB01F8FF updated
	BSR.L	lbC01F030
	RTS

lbC01F3A8	BSR.S	lbC01F392
	CLR.B	lbB01F8FE
	RTS

SetTempo	LINK.W	A6,#-4
	MOVE.B	lbB01F8FE,D0
	EXT.W	D0
	EXT.L	D0
	MOVE.L	D0,-4(A6)
	BSR.S	lbC01F392
	MOVEQ	#9,D0
	MOVE.W	10(A6),D1
	ANDI.L	#$FFFF,D1
	ASL.L	D0,D1
	MOVE.L	D1,D0
	MOVE.L	#$96,D1
	JSR	lbC023E80
	MOVE.L	D0,lbL01FA68
	TST.L	-4(A6)
	BNE.S	lbC01F3F0
	BSR.S	lbC01F3A8
lbC01F3F0	UNLK	A6
	RTS

Initmus	LINK.W	A6,#-10
	MOVEQ	#1,D0
	MOVE.B	D0,lbB01F8FE
	EXT.W	D0
	MOVE.W	D0,musicDone
	CLR.B	lbB01F8FF
	MOVEQ	#$70,D0
	MOVE.L	D0,-(SP)
	PEA	lbL01FCE2
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$70,D0
	MOVE.L	D0,-(SP)
	PEA	lbL01FDB2
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVE.L	#$200,-(SP)
	PEA	lbL01FAE2
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$5C,D0
	MOVE.L	D0,-(SP)
	PEA	lbL01FA82
	JSR	_Zero
	ADDQ.L	#8,SP
;	MOVEQ	#$16,D0
;	MOVE.L	D0,-(SP)
;	PEA	lbL01FA6C
;	JSR	_Zero
;	ADDQ.L	#8,SP
	MOVE.L	#lbL01FAE2,lbL01FABC
	LEA	lbW01FCE0,A0
	MOVE.L	A0,lbL01FAB8
	MOVE.L	A0,lbL01FAC0
	MOVE.B	#1,lbB01FA8A
	MOVE.W	lbW01F8F8,D0			>>> other impl loads task prio here..
	MOVE.B	D0,lbB01FA8B
	MOVE.L	#lbL01FA82,lbL01FADE
	MOVE.L	#lbL01FCE2,-6(A6)
	CLR.W	-2(A6)
lbC01F4B0	MOVE.W	-2(A6),D0
	CMPI.W	#8,D0
	BGE.S	lbC01F516
	EXT.L	D0
	MOVE.L	D0,0(SP)
	ASL.L	#4,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F91A,A0
	MOVEA.L	-6(A6),A1
	MOVE.L	A1,(A0)
	MOVE.L	0(SP),D0
	MOVEQ	#12,D1
	JSR	_CX33
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FD52,A0
	MOVE.L	A0,10(A1)
	MOVE.L	0(SP),D0
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F9A2,A0
	MOVEQ	#-1,D0
	MOVE.L	D0,(A0)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL01F9C2,A0
	MOVE.B	#$C1,(A0)			>>>>>>>>>>> #1 in other impl
	ADDI.L	#14,-6(A6)
	ADDQ.W	#1,-2(A6)
	BRA.S	lbC01F4B0

lbC01F516	MOVE.L	#lbL01FDB2,-6(A6)
	CLR.W	-2(A6)
lbC01F522	MOVE.W	-2(A6),D0
	CMPI.W	#8,D0
	BGE.S	lbC01F554
	MOVEA.L	-6(A6),A0
	MOVE.W	#$FFFE,4(A0)
	MULS.W	#12,D0
	MOVEA.L	D0,A1
	ADDA.L	#lbL01FE22,A1
	MOVE.L	A1,10(A0)
	ADDI.L	#14,-6(A6)
	ADDQ.W	#1,-2(A6)
	BRA.S	lbC01F522

lbC01F554	MOVE.L	#$4B00,-(SP) >>>>>>>>>>>> #2 in other impl

	BSR.L	SetTempo
	ADDQ.L	#4,SP
	CLR.L	-(SP)
	
	PEA	runTask2_lbC01F2FA(PC)
	PEA	lbL01FA82
	JSR	_AddTask
	
	LEA	12(SP),SP
;	MOVEQ	#$16,D0
;	MOVE.L	D0,-(SP)
;	PEA	lbL01FA6C
;	JSR	_Zero
;	ADDQ.L	#8,SP
;	LEA	lbC01F260(PC),A0
;	MOVE.L	A0,lbL01FA7E
;	MOVE.B	#2,lbB01FA74
;	PEA	lbL01FA6C
;	MOVEQ	#5,D0
;	MOVE.L	D0,-(SP)
;	JSR	_AddIntServer
;	ADDQ.L	#8,SP
	UNLK	A6
	RTS

ResetMus	BSR.L	lbC01F392
;	PEA	lbL01FA6C
;	MOVEQ	#5,D0
;	MOVE.L	D0,-(SP)
;	JSR	_RemIntServer
;	ADDQ.L	#8,SP
	PEA	lbL01FA82
	JSR	_RemTask
	ADDQ.L	#4,SP
	RTS

StartMus	LINK.W	A6,#-4
	MOVEM.L	A2,-(SP)
	BSR.L	lbC01F392
	MOVE.L	8(A6),lbL01FA1A
	MOVE.W	14(A6),lbW01FA1E
	MOVE.B	$13(A6),lbB01FA24		>>>>>>>> other impl also allocs SIgnal..
	CLR.L	-(SP)
	JSR	_FindTask
	
	
	ADDQ.L	#4,SP
	MOVEQ	#$20,D1
	MOVE.L	D1,-(SP)
	PEA	lbL01F9CA
	MOVE.L	D0,lbL01FA20
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$10,D0
	MOVE.L	D0,-(SP)
	PEA	lbL01F9FA
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$10,D0
	MOVE.L	D0,-(SP)
	PEA	lbL01F9EA
	JSR	_Zero
	ADDQ.L	#8,SP
	CLR.L	-4(A6)
lbC01F644	MOVE.L	-4(A6),D0
	CMPI.L	#8,D0
	BGE.S	lbC01F694
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FA0A,A0
	MOVE.L	-4(A6),D0
	ASL.L	#3,D0
	MOVEA.L	lbL01FA1A,A1
	ADDA.L	D0,A1
	MOVEA.L	(A1),A2

	cmp.l	#0,A2
	beq.b	SkipZero

	MOVE.W	(A2),(A0)
SkipZero
	MOVE.L	-4(A6),D0
	ASL.L	#4,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F91A,A0
	MOVE.B	#$80,14(A0)
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F91A,A0
	MOVE.B	#1,15(A0)
	ADDQ.L	#1,-4(A6)
	BRA.S	lbC01F644

lbC01F694	MOVEQ	#0,D0
	MOVE.W	D0,musicDone
	MOVE.W	$16(A6),D0
	MOVE.W	D0,lbW01F8FC
	TST.W	D0
	BNE.S	lbC01F6C0
	CLR.L	-4(A6)
lbC01F6AE	
	BSR.L	playerRoutine
	ADDQ.L	#1,-4(A6)
	MOVE.W	musicDone,D0
	TST.W	D0
	BEQ.S	lbC01F6AE
lbC01F6C0	BSR.L	lbC01F3A8
	MOVE.L	-4(A6),D0
	MOVEM.L	(SP)+,A2
	UNLK	A6
	RTS

lbC01F6D0	LINK.W	A6,#0
	MOVEM.L	D2,-(SP)
	MOVEQ	#0,D0
	MOVE.W	14(A6),D0
	MOVE.B	$13(A6),D1
	EXT.W	D1
	EXT.L	D1
	MOVEQ	#1,D2
	MOVE.L	D2,-(SP)
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	MOVE.L	8(A6),-(SP)
	BSR.L	StartMus
	LEA	$10(SP),SP
	MOVEM.L	(SP)+,D2
	UNLK	A6
	RTS

;	LINK.W	A6,#0
;	MOVEQ	#0,D0
;	MOVE.W	14(A6),D0
;	MOVEQ	#0,D1
;	MOVE.L	D1,-(SP)
;	MOVE.L	D1,-(SP)
;	MOVE.L	D0,-(SP)
;	MOVE.L	8(A6),-(SP)
;	BSR.L	StartMus
;	LEA	$10(SP),SP
;	UNLK	A6
;	RTS

;	LINK.W	A6,#0
;	MOVE.B	11(A6),D0
;	ADDQ.B	#5,D0
;	MOVE.B	D0,lbB01FA25
;	UNLK	A6
;	RTS

;	LEA	lbL01FA26,A0
;	MOVE.L	A0,D0
;	RTS

lbC01F742	LINK.W	A6,#-4
	MOVEQ	#1,D0
	MOVE.L	D0,-4(A6)
lbC01F74C	MOVE.L	-4(A6),D0
	MOVEQ	#1,D1
	ASL.L	D0,D1
	MOVEA.L	8(A6),A0
	MOVE.L	(A0),D0
	AND.L	D1,D0
	TST.L	D0
	BNE.S	lbC01F77A
	MOVE.L	4(A0),D0
	AND.L	D1,D0
	TST.L	D0
	BNE.S	lbC01F77A
	CMPI.L	#9,-4(A6)
	BGE.S	lbC01F77A
	ADDQ.L	#1,-4(A6)
	BRA.S	lbC01F74C

lbC01F77A	MOVE.L	-4(A6),D0
	UNLK	A6
	RTS

lbC01F782	LINK.W	A6,#-$14
	MOVEM.L	D2/D3/A5,-(SP)
	MOVEQ	#0,D0
	MOVE.B	11(A6),D0
	MOVE.L	D0,12(SP)
	ASL.L	#4,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F91A,A0
	MOVEA.L	A0,A5
	MOVE.L	12(SP),D0
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FE82,A0
	MOVE.L	$14(A6),(A0)
	MOVE.L	12(SP),D0
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01FEA2,A0
	MOVE.L	$18(A6),(A0)
	MOVEA.L	$10(A6),A0
	MOVE.L	8(A0),D0
	MOVE.L	D0,-8(A6)
	TST.L	D0
	BNE.S	lbC01F7E2
	MOVE.L	A0,-(SP)
	BSR.L	lbC01F742
	ADDQ.L	#4,SP
	MOVE.L	D0,-12(A6)
	BRA.S	lbC01F818

lbC01F7E2	MOVEQ	#1,D0
	MOVE.L	D0,-12(A6)
lbC01F7E8	MOVE.L	-12(A6),D0
	MOVEQ	#1,D1
	ASL.L	D0,D1
	CMP.L	-8(A6),D1
	BCC.S	lbC01F7FC
	ADDQ.L	#1,-12(A6)
	BRA.S	lbC01F7E8

lbC01F7FC	MOVE.L	-12(A6),D0
	MOVEQ	#1,D1
	ASL.L	D0,D1
	CMP.L	-8(A6),D1
	BEQ.S	lbC01F818
	MOVE.L	$10(A6),-(SP)
	BSR.L	lbC01F742
	ADDQ.L	#4,SP
	MOVE.L	D0,-12(A6)
lbC01F818	MOVEQ	#0,D0
	MOVEA.L	$10(A6),A0
	MOVE.B	14(A0),D0
	MOVE.L	D0,-$10(A6)
	CMPI.L	#9,D0
	BLS.S	lbC01F834
	MOVEQ	#9,D0
	MOVE.L	D0,-$10(A6)
lbC01F834	TST.L	-$10(A6)
	BNE.S	lbC01F840
	MOVEQ	#1,D0
	MOVE.L	D0,-$10(A6)
lbC01F840	MOVEQ	#10,D0
	SUB.L	-$10(A6),D0
	MOVE.L	D0,-8(A6)
	CMP.L	-12(A6),D0
	BCC.S	lbC01F854
	MOVE.L	D0,-12(A6)
lbC01F854	MOVEQ	#9,D0
	MOVE.L	-12(A6),D1
	SUB.L	D1,D0
	MOVE.B	D0,12(A5)
	MOVE.L	-8(A6),D0
	SUB.L	D1,D0
	MOVE.B	D0,13(A5)
	MOVEA.L	$10(A6),A0
	MOVE.L	4(A0),D0
	LSR.L	D1,D0
	MOVE.W	D0,10(A5)
	MOVE.L	(A0),D2
	LSR.L	D1,D2
	MOVEQ	#0,D3
	MOVE.W	10(A5),D3
	ADD.L	D3,D2
	MOVE.W	D2,8(A5)
	SUBQ.L	#1,D1
	MOVEQ	#1,D0
	ASL.L	D1,D0
	MOVEQ	#0,D1
	MOVE.W	8(A5),D1
	JSR	lbC023EF8
	ASL.L	#1,D0
	MOVEA.L	12(A6),A0
	SUBA.L	D0,A0
	MOVE.L	A0,4(A5)
	MOVEA.L	(A5),A0
	MOVE.W	#1,4(A0)
	TST.W	10(A5)
	BEQ.S	lbC01F8CE
	MOVEQ	#0,D0
	MOVE.B	11(A6),D0
	MOVEQ	#14,D1
	JSR	_CX33
	MOVEA.L	D0,A1
	ADDA.L	#lbL01FDB2,A1
	MOVE.L	A1,(A0)
	BRA.S	lbC01F8D2

lbC01F8CE	MOVEA.L	(A5),A0
	CLR.L	(A0)
lbC01F8D2	MOVEM.L	(SP)+,D2/D3/A5
	UNLK	A6
	RTS

lbC01F8DA	LINK.W	A6,#0
	MOVEQ	#0,D0
	MOVE.B	11(A6),D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL01F99A,A0
	MOVE.B	15(A6),(A0)
	UNLK	A6
	RTS


;	SECTION	MarbleMadness01F8F4,DATA
jiffyClock	dc.l	0
lbW01F8F8	dc.w	6
musicDone	dc.w	1
lbW01F8FC	dc.w	1
lbB01F8FE	dc.b	1
lbB01F8FF	dc.b	0


*************************** signal used by "INT-handler" to signal "Task2"

signalFromIntHandler	dc.w	0

lbL01F902	dc.l	$1AC0194
	dc.l	$17D0168
	dc.l	$1530140
	dc.l	$12E011D
	dc.l	$10D00FE
	dc.l	$F000E2
lbL01F91A	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01F99A	dc.l	$1010101
	dc.l	0
lbL01F9A2	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01F9C2	dc.l	0
	dc.l	0
lbL01F9CA	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01F9EA	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01F9FA	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01FA0A	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL01FA1A	dc.l	0
lbW01FA1E	dc.w	0
lbL01FA20	dc.l	0
lbB01FA24	dc.b	0
lbB01FA25	dc.b	5
lbL01FA26	dc.l	$10000
	dc.l	$600000
	dc.l	$300000
	dc.l	$180000
	dc.l	$C0000
	dc.l	$60000
	dc.l	$30000
	dc.l	$20000
	dc.l	$480000
	dc.l	$240000
	dc.l	$120000
	dc.l	$90000
	dc.l	$200000
	dc.l	$100000
	dc.l	$80000
	dc.l	$40000
maxDelay	dc.w	0

;	SECTION	MarbleMadness01FA68,BSS
lbL01FA68	ds.l	1
;lbL01FA6C	ds.l	2
;lbB01FA74	ds.b	10
;lbL01FA7E	ds.l	1
lbL01FA82	ds.l	2
lbB01FA8A	ds.b	1
lbB01FA8B	ds.b	$2D
lbL01FAB8	ds.l	1
lbL01FABC	ds.l	1
lbL01FAC0	ds.l	7		; TASK prio?
	ds.w	1
lbL01FADE	ds.l	1
lbL01FAE2	ds.l	$7F
	ds.w	1
lbW01FCE0	ds.w	1
lbL01FCE2	ds.l	$1C
lbL01FD52	ds.l	$18
lbL01FDB2	ds.l	$1C
lbL01FE22	ds.l	$18
lbL01FE82	ds.l	8
lbL01FEA2	ds.l	8
	ds.w	1


;	SECTION	MarbleMadness01FEC4,CODE
MakePort	LINK.W	A6,#0
	MOVEQ	#0,D0
	MOVEA.L	8(A6),A0
	MOVE.B	D0,14(A0)
	MOVE.B	D0,9(A0)
	CLR.L	10(A0)
	MOVE.B	#4,8(A0)
	MOVEQ	#-1,D0
	MOVE.L	D0,-(SP)
	JSR	_AllocSignal
	ADDQ.L	#4,SP
	MOVEA.L	8(A6),A0
	MOVE.B	D0,15(A0)
	CLR.L	-(SP)
	JSR	_FindTask
	ADDQ.L	#4,SP
	MOVEA.L	8(A6),A0
	MOVE.L	D0,$10(A0)
	ADDA.W	#$14,A0
	MOVE.L	A0,-(SP)
	JSR	_NewList
	ADDQ.L	#4,SP
	UNLK	A6
	RTS

UnmakePort	LINK.W	A6,#0
	MOVEQ	#0,D0
	MOVEA.L	8(A6),A0
	MOVE.B	15(A0),D0
	MOVE.L	D0,-(SP)
	JSR	_FreeSignal
	ADDQ.L	#4,SP
	UNLK	A6
	RTS

lbC01FF34_openADetc	
	LINK.W	A6,#-$12
	MOVEQ	#$44,D0		>>>> 68 bytes
	MOVE.L	D0,-(SP)
	PEA	AudioIO_request
	JSR	_Zero
	ADDQ.L	#8,SP
	
	MOVEQ	#0,D0
	MOVE.L	D0,-(SP)
	PEA	AudioIO_request
	MOVE.L	D0,-(SP)
	PEA	audiodevice.MSG
	JSR	_OpenDevice
	LEA	$10(SP),SP
	
	MOVE.L	messagePort1,audioio_msgPort		=> set after completion of device-open
	<<<<<<<<<<<<<<<<<<<<<<<
	MOVEQ	#14,D0
	MOVE.L	D0,-(SP)
	PEA	some_list
	JSR	_Zero
	ADDQ.L	#8,SP
	
	PEA	some_list
	JSR	_NewList
	CCCCCCCCCCCCCC
	ADDQ.L	#4,SP
	MOVE.L	#lbL021250,-10(A6)
	MOVE.B	#1,-5(A6)
	CLR.L	-4(A6)
	CCCCCCCCCCCCCCCCC
	
lbC01FFA2	
	MOVE.L	-4(A6),D0
	CMPI.L	#4,D0
	BCC.L	lbC0200CC
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	MOVE.L	A0,0(SP)
	ADDA.L	#lbL021138,A0
	MOVE.L	-4(A6),D0
	MOVEQ	#$24,D1
	JSR	_CX33
	MOVEA.L	D0,A1
	ADDA.L	#lbL021018,A1
	MOVE.L	A1,(A0)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL021138,A0
	MOVEA.L	(A0),A1
	MOVE.L	#lbW021158,$16(A1)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL021138,A0
	MOVE.L	(A0),-(SP)
	PEA	some_list
	JSR	_AddHead
	
	ADDQ.L	#8,SP
	MOVE.L	-4(A6),D0
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	MOVE.L	A0,0(SP)
	ADDA.L	#lbL021148,A0
	MOVE.L	-4(A6),D0
	MOVEQ	#$24,D1
	JSR	_CX33
	MOVEA.L	D0,A1
	ADDA.L	#lbL0210A8,A1
	MOVE.L	A1,(A0)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL021148,A0
	MOVEA.L	(A0),A1
	MOVE.L	#lbW021158,$16(A1)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL021148,A0
	MOVE.L	(A0),-(SP)
	PEA	some_list
	JSR	_AddHead
	
	ADDQ.L	#8,SP
	MOVE.L	-4(A6),D0
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021470,A0
	MOVEA.L	-10(A6),A1
	MOVE.L	A1,(A0)
	MOVEQ	#$44,D0
	MOVE.L	D0,-(SP)
	MOVE.L	A1,-(SP)
	PEA	AudioIO_request
	JSR	_Copy
	LEA	12(SP),SP
	MOVEA.L	-10(A6),A0
	MOVE.W	#$20,$1C(A0)
	MOVE.B	#$7F,9(A0)
	MOVE.B	#$41,$1E(A0)
	LEA	-5(A6),A1
	MOVE.L	A1,$22(A0)
	MOVEQ	#1,D0
	MOVE.L	D0,$26(A0)
	MOVE.L	A0,-(SP)
	JSR	_BeginIO
	
	ADDQ.L	#4,SP
	ADDI.L	#$44,-10(A6)
	MOVEQ	#0,D0
	MOVE.B	-5(A6),D0
	ASL.L	#1,D0
	MOVE.B	D0,-5(A6)
	ADDQ.L	#1,-4(A6)
	BRA.L	lbC01FFA2

lbC0200CC	MOVE.L	#lbL021250,-10(A6)
	MOVE.L	#lbL021360,-14(A6)
	MOVEQ	#4,D0
	MOVE.L	D0,-4(A6)
lbC0200E2	MOVE.L	-4(A6),D0
	CMPI.L	#8,D0
	BCC.S	lbC020128
	ASL.L	#2,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021470,A0
	MOVEA.L	-14(A6),A1
	MOVE.L	A1,(A0)
	MOVEQ	#$44,D0
	MOVE.L	D0,-(SP)
	MOVE.L	A1,-(SP)
	MOVE.L	-10(A6),-(SP)
	JSR	_Copy
	LEA	12(SP),SP
	ADDI.L	#$44,-10(A6)
	ADDI.L	#$44,-14(A6)
	ADDQ.L	#1,-4(A6)
	BRA.S	lbC0200E2

lbC020128	UNLK	A6
	RTS

lbC02012C	LINK.W	A6,#-2
	MOVEM.L	D7,-(SP)
	MOVE.B	11(A6),D7
	MOVE.L	D7,D0
	EXT.W	D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FEC,A0
	MOVE.W	8(A6),D0
	MOVE.W	(A0),D1
	CMP.W	D1,D0
	BEQ.S	lbC020154
	MOVEQ	#-1,D7
lbC020154	MOVE.L	D7,D0
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC02015E	LINK.W	A6,#-$52
	MOVEM.L	D7,-(SP)
	MOVE.B	11(A6),D0
	EXT.W	D0
	EXT.L	D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021010,A0
	CLR.B	(A0)
	MOVEA.L	D0,A0
	ADDA.L	#lbL02100C,A0
	TST.B	(A0)
	BEQ.S	lbC02018C
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC02018C	MOVE.L	#lbL021250,-$4E(A6)
	CLR.L	-6(A6)
	MOVE.B	11(A6),D0
	EXT.W	D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021004,A0
	MOVE.W	(A0),D7

loop:
lbC0201AC	MOVE.L	D7,D0
	BTST	#0,D0
	BEQ.S	lbC0201F0
	MOVEQ	#$44,D0
	MOVE.L	D0,-(SP)
	PEA	-$4A(A6)
	MOVE.L	-$4E(A6),-(SP)
	JSR	_Copy
	LEA	12(SP),SP
	MOVE.W	#8,-$2E(A6)
	MOVE.B	#1,-$2C(A6)
	PEA	-$4A(A6)
	JSR	_BeginIO
	ADDQ.L	#4,SP
	MOVEA.L	-6(A6),A0
	ADDA.L	#lbL020FD8,A0
	MOVE.B	#$FF,(A0)
	
lbC0201F0	ADDI.L	#$44,-$4E(A6)
	ADDQ.L	#1,-6(A6)
	MOVE.L	D7,D0
	ASR.W	#1,D7
	BNE.S	lbC0201AC
	MOVE.B	11(A6),D0
	EXT.W	D0
	EXT.L	D0
	MOVE.L	D0,4(SP)
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021004,A0
	CLR.W	(A0)
	MOVEA.L	4(SP),A0
	ADDA.L	#lbL02100C,A0
	MOVE.B	#1,(A0)
	MOVE.L	4(SP),D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FEC,A0
	MOVE.W	(A0),D0
	ADDQ.W	#1,D0
	MOVE.W	D0,(A0)
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC020244	LINK.W	A6,#-6
	MOVEM.L	D6/D7,-(SP)
	MOVE.L	8(A6),D7
	MOVEQ	#0,D6
lbC020252	MOVE.L	D7,D0
	BTST	#0,D0
	BEQ.S	lbC020266
	MOVEA.L	D6,A0
	ADDA.L	#lbL020FD8,A0
	MOVE.B	15(A6),(A0)
lbC020266	ADDQ.L	#1,D6
	MOVE.L	D7,D0
	ASR.W	#1,D7
	BNE.S	lbC020252
	MOVEM.L	(SP)+,D6/D7
	UNLK	A6
	RTS

lbC020276	LINK.W	A6,#-12
	MOVEM.L	D2/D5-D7,-(SP)
lbC02027E	MOVEQ	#0,D5
lbC020280	MOVE.W	#1,-12(A6)
	MOVEQ	#0,D6
	MOVE.L	D5,D0
	MOVE.L	D5,D1
	ASL.L	#1,D1
	MOVEA.L	$10(A6),A0
	ADDA.L	D1,A0
	MOVE.W	(A0),D7
lbC020296	MOVE.L	D7,D0
	BTST	#0,D0
	BEQ.S	lbC0202B4
	MOVEA.L	D6,A0
	ADDA.L	#lbL020FD8,A0
	MOVE.B	(A0),D0
	CMPI.B	#$FF,D0
	BEQ.S	lbC0202B4
	CLR.W	-12(A6)
	BRA.S	lbC0202BC

lbC0202B4	ADDQ.L	#1,D6
	MOVE.L	D7,D0
	ASR.W	#1,D7
	BNE.S	lbC020296
lbC0202BC	TST.W	-12(A6)
	BEQ.S	lbC0202E8
	MOVE.L	D5,D0
	MOVE.L	D5,D1
	ASL.L	#1,D1
	MOVEA.L	$10(A6),A0
	ADDA.L	D1,A0
	MOVE.W	(A0),D1
	EXT.L	D1
	MOVEQ	#4,D2
	MOVE.L	D2,-(SP)
	MOVE.L	D1,-(SP)
	BSR.L	lbC020244
	ADDQ.L	#8,SP
	MOVE.L	D5,D0
	MOVEM.L	(SP)+,D2/D5-D7
	UNLK	A6
	RTS

lbC0202E8	ADDQ.L	#1,D5
	MOVE.L	D5,D0
	MOVE.B	11(A6),D1
	EXT.W	D1
	EXT.L	D1
	CMP.L	D1,D0
	BCS.S	lbC020280
	MOVEQ	#0,D5
lbC0202FA	MOVE.L	D5,D0
	MOVE.L	D5,D1
	ASL.L	#1,D1
	MOVEA.L	$10(A6),A0
	ADDA.L	D1,A0
	MOVE.W	(A0),D7
	MOVEQ	#0,D6
lbC02030A	CMPI.L	#4,D6
	BCC.S	lbC02035C
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021004,A0
	MOVE.W	(A0),D1
	CMP.W	D7,D1
	BNE.S	lbC020358
	MOVEA.L	D0,A0
	ADDA.L	#lbL021014,A0
	MOVE.B	(A0),D1
	CMP.B	15(A6),D1
	BGE.S	lbC020358
	MOVE.L	D0,-(SP)
	BSR.L	lbC02015E
	ADDQ.L	#4,SP
	MOVE.L	D7,D0
	EXT.L	D0
	MOVEQ	#4,D1
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	lbC020244
	ADDQ.L	#8,SP
	MOVE.L	D5,D0
	MOVEM.L	(SP)+,D2/D5-D7
	UNLK	A6
	RTS

lbC020358	ADDQ.L	#1,D6
	BRA.S	lbC02030A

lbC02035C	ADDQ.L	#1,D5
	MOVE.L	D5,D0
	MOVE.B	11(A6),D1
	EXT.W	D1
	EXT.L	D1
	CMP.L	D1,D0
	BCS.S	lbC0202FA
	MOVEQ	#0,D5
lbC02036E	MOVE.L	D5,D0
	MOVE.L	D5,D1
	ASL.L	#1,D1
	MOVEA.L	$10(A6),A0
	ADDA.L	D1,A0
	MOVE.W	(A0),D7
	MOVEQ	#0,D6
lbC02037E	CMPI.L	#4,D6
	BCC.S	lbC0203BC
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021004,A0
	MOVE.W	(A0),D1
	AND.W	D7,D1
	TST.W	D1
	BEQ.S	lbC0203B8
	MOVEA.L	D0,A0
	ADDA.L	#lbL021014,A0
	MOVE.B	(A0),D1
	CMP.B	15(A6),D1
	BGE.S	lbC0203B8
	MOVE.L	D0,-(SP)
	BSR.L	lbC02015E
	ADDQ.L	#4,SP
	BRA.L	lbC02027E

lbC0203B8	ADDQ.L	#1,D6
	BRA.S	lbC02037E

lbC0203BC	ADDQ.L	#1,D5
	MOVE.L	D5,D0
	MOVE.B	11(A6),D1
	EXT.W	D1
	EXT.L	D1
	CMP.L	D1,D0
	BCS.S	lbC02036E
	MOVEQ	#-1,D0
	MOVEM.L	(SP)+,D2/D5-D7
	UNLK	A6
	RTS
#####################################################################################################################
lbC0203D6	LINK.W	A6,#-12
	MOVE.W	14(A6),D0
	EXT.L	D0
	CMPI.L	#$FFFFFFFE,D0
	BEQ.S	lbC020400
	CMPI.L	#$FFFFFFFF,D0
	BNE.S	lbC020410
	MOVEQ	#2,D0
	MOVE.L	D0,-4(A6)
	MOVE.L	#lbW020FE0,-12(A6)
	BRA.S	lbC02041E

lbC020400	MOVEQ	#2,D0
	MOVE.L	D0,-4(A6)
	MOVE.L	#lbW020FDC,-12(A6)
	BRA.S	lbC02041E

lbC020410	MOVEQ	#4,D0
	MOVE.L	D0,-4(A6)
	MOVE.L	#lbW020FE4,-12(A6)
lbC02041E	MOVE.W	10(A6),D0
	EXT.L	D0
	MOVE.L	-12(A6),-(SP)
	MOVE.L	D0,-(SP)
	MOVE.L	-4(A6),-(SP)
	BSR.L	lbC020276
	LEA	12(SP),SP
	EXT.L	D0
	MOVE.L	D0,-8(A6)
	ADDQ.L	#1,D0
	BNE.S	lbC020446
	MOVEQ	#0,D0
	UNLK	A6
	RTS

lbC020446	MOVE.L	-8(A6),D0
	ASL.L	#1,D0
	MOVEA.L	-12(A6),A0
	ADDA.L	D0,A0
	MOVE.W	(A0),D0
	UNLK	A6
	RTS

lbC020458	LINK.W	A6,#-10
	MOVEM.L	D7,-(SP)
	MOVEQ	#0,D7
lbC020462	MOVE.L	D7,D0
	EXT.W	D0
	EXT.L	D0
	MOVEA.L	D0,A0
	MOVE.L	A0,4(SP)
	ADDA.L	#lbL02100C,A0
	TST.B	(A0)
	BEQ.S	lbC0204D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL02100C,A0
	CLR.B	(A0)
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FEC,A0
	MOVE.W	(A0),D0
	ADDQ.W	#1,D0
	MOVE.W	D0,(A0)
	MOVE.B	#$53,-4(A6)
	MOVE.L	4(SP),D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FEC,A0
	MOVE.L	4(SP),D0
	ASL.L	#1,D0
	MOVEA.L	D0,A1
	ADDA.L	#lbL020FEC,A1
	MOVE.W	(A1),D0
	ANDI.W	#$7FFF,D0
	MOVE.W	D0,(A0)
	MOVE.W	D0,-6(A6)
	MOVE.B	D7,-3(A6)
	MOVE.L	-6(A6),D0
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC0204D0	ADDQ.B	#1,D7
	CMPI.B	#4,D7
	BLT.S	lbC020462
	MOVEQ	#-1,D0
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS
	
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV different
lbC0204E2	LINK.W	A6,#-14
	MOVEM.L	D4-D7,-(SP)
	MOVE.B	11(A6),D0
	EXT.W	D0
	EXT.L	D0
	MOVEA.L	D0,A0
	MOVE.L	A0,$10(SP)
	ADDA.L	#lbL021164,A0
	TST.B	(A0)
	BEQ.S	lbC020572
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FF4,A0
	MOVE.W	(A0),D5
	MOVE.L	$10(SP),D0
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021004,A0
	MOVE.W	(A0),D7
	MOVEQ	#0,D6
lbC020520	MOVE.L	D7,D0
	BTST	#0,D0
	BEQ.S	lbC02056A
	MOVE.L	D5,D0
	MULU.W	#$CD,D0
	LSR.W	#8,D0
	MOVE.L	D0,D4
	CMPI.L	#1,D6
	BEQ.S	lbC020542
	CMPI.L	#2,D6
	BNE.S	lbC020554
lbC020542	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FBC,A0
	MOVE.W	D4,(A0)
	BRA.S	lbC02056A

lbC020554	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FBC,A0
	MOVE.W	#$100,D1
	SUB.W	D4,D1
	MOVE.W	D1,(A0)
lbC02056A	ADDQ.L	#1,D6
	MOVE.L	D7,D0
	ASR.W	#1,D7
	BNE.S	lbC020520
lbC020572	MOVEM.L	(SP)+,D4-D7
	UNLK	A6
	RTS

lbC02057A	LINK.W	A6,#-$14
	MOVEM.L	D7/A3-A5,-(SP)
	MOVE.L	8(A6),D7
lbC020586	MOVEA.L	D7,A0
	ADDA.L	#lbL020FD4,A0
	TST.B	(A0)
	BEQ.S	lbC02059A
	MOVEM.L	(SP)+,D7/A3-A5
	UNLK	A6
	RTS

lbC02059A	MOVE.L	D7,D0
	MULS.W	#14,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021490,A0
	MOVEA.L	A0,A4
	MOVE.W	4(A4),D0
	TST.W	D0
	BMI.S	lbC0205B8
	SUBQ.W	#1,D0
	MOVE.W	D0,4(A4)
lbC0205B8	MOVE.W	4(A4),D0
	ADDQ.W	#1,D0
	BNE.S	lbC0205E6
	TST.L	(A4)
	BEQ.S	lbC0205D2
	MOVEA.L	(A4),A0
	MOVEA.L	A4,A1
	MOVEQ	#13,D0
lbC0205CA	MOVE.B	(A0)+,(A1)+
	DBRA	D0,lbC0205CA
	BRA.S	lbC020586

lbC0205D2	MOVEA.L	D7,A0
	ADDA.L	#lbL020FD4,A0
	MOVE.B	#1,(A0)
	MOVEM.L	(SP)+,D7/A3-A5
	UNLK	A6
	RTS

lbC0205E6	TST.L	6(A4)
	BEQ.S	lbC0205EE
	BRA.S	lbC020586

lbC0205EE	MOVEA.L	10(A4),A5
	MOVEA.L	12(A6),A3
	TST.L	$10(A6)
	BEQ.S	lbC020622
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FB4,A0
	MOVE.W	6(A5),(A0)
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FAC,A0
	MOVE.W	4(A5),(A0)
	MOVE.B	#$10,$1E(A3)
	BRA.S	lbC020626

lbC020622	CLR.B	$1E(A3)
lbC020626	MOVE.L	8(A5),$22(A3)
	MOVE.L	(A5),D0
	ASL.L	#1,D0
	MOVE.L	D0,$26(A3)
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FCC,A0
	MOVE.L	D0,-(SP)
	MOVE.L	A0,$14(SP)
	JSR	lbC021708
	ADDQ.L	#4,SP
	MOVEA.L	$10(SP),A0
	MOVE.W	D0,(A0)
	MOVE.W	D0,$2A(A3)
	MOVE.L	D7,D0
	MOVE.L	D7,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FC4,A0
	MOVE.L	D0,-(SP)
	MOVE.L	A0,$14(SP)
	JSR	lbC021850
	ADDQ.L	#4,SP
	MOVEA.L	$10(SP),A0
	MOVE.W	D0,(A0)
	MOVE.W	D0,$2C(A3)
	MOVE.W	4(A4),D0
	ADDQ.W	#2,D0
	BNE.S	lbC02068E
	CLR.W	$2E(A3)
	BRA.S	lbC02069C

lbC02068E	MOVE.W	4(A4),D0
	ADDQ.W	#1,D0
	MOVE.W	D0,4(A4)
	MOVE.W	D0,$2E(A3)
lbC02069C	CLR.W	4(A4)
	MOVE.W	#3,$1C(A3)
	MOVE.L	A3,-(SP)
	JSR	_BeginIO
	ADDQ.L	#4,SP
	MOVEM.L	(SP)+,D7/A3-A5
	UNLK	A6
	RTS

lbC0206B8	LINK.W	A6,#-6
	MOVEM.L	D7,-(SP)
	MOVEA.L	8(A6),A0
	MOVE.L	$14(A0),-(SP)
	BSR.L	lbC02012C
	ADDQ.L	#4,SP
	MOVE.L	D0,D7
	TST.B	D7
	BPL.S	lbC0206DC
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC0206DC	MOVE.L	D7,D0
	EXT.W	D0
	EXT.L	D0
	MOVE.L	D0,4(SP)
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FF4,A0
	MOVEA.L	8(A6),A1
	MOVE.W	$18(A1),(A0)
	MOVE.L	4(SP),-(SP)
	BSR.L	lbC0204E2
	ADDQ.L	#4,SP
	MOVEM.L	(SP)+,D7
	UNLK	A6
	RTS

lbC02070A	LINK.W	A6,#-$32
	PEA	-$32(A6)
	JSR	_NewList
	ADDQ.L	#4,SP
	MOVEQ	#$24,D0
	MOVE.L	D0,-(SP)
	PEA	-$24(A6)
	JSR	_Zero
	ADDQ.L	#8,SP
	TST.L	12(A6)
	BNE.S	lbC020738
	MOVE.L	#lbW021158,12(A6)
lbC020738	MOVE.L	12(A6),-14(A6)
	PEA	-$24(A6)
	PEA	-$32(A6)
	JSR	_AddHead
	ADDQ.L	#8,SP
	PEA	-$32(A6)
	JSR	lbC021954
	ADDQ.L	#4,SP
	MOVEA.L	8(A6),A0
	MOVE.L	-14(A6),$16(A0)
	MOVE.L	-$16(A6),14(A0)
	UNLK	A6
	RTS

lbC02076E	LINK.W	A6,#-14
	MOVEM.L	D5-D7/A2,-(SP)
	MOVEQ	#-1,D0
	MOVEA.L	8(A6),A0
	MOVE.L	D0,$14(A0)
	BSR.L	lbC020458
	MOVEA.L	8(A6),A0
	MOVE.L	D0,$14(A0)
	ADDQ.L	#1,D0
	BNE.S	lbC020798
	MOVEM.L	(SP)+,D5-D7/A2
	UNLK	A6
	RTS

lbC020798	MOVEA.L	8(A6),A0
	MOVE.L	$14(A0),-(SP)
	BSR.L	lbC02012C
	ADDQ.L	#4,SP
	MOVE.L	D0,D5
	EXT.W	D5
	EXT.L	D5
	MOVEA.L	D5,A0
	ADDA.L	#lbL021014,A0
	MOVEA.L	8(A6),A1
	MOVE.B	$1B(A1),(A0)
	MOVE.L	D5,D0
	MOVE.L	D5,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FF4,A0
	MOVE.W	$18(A1),(A0)
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FFC,A0
	MOVE.W	$1E(A1),(A0)
	MOVEA.L	D1,A0
	ADDA.L	#lbL021004,A0
	MOVE.W	$1C(A1),D1
	MOVE.W	D1,(A0)
	MOVE.L	D1,D7
	MOVE.L	D7,D1
	EXT.L	D1
	MOVE.L	D0,-(SP)
	MOVE.L	D1,-(SP)
	BSR.L	lbC020244
	ADDQ.L	#8,SP
	MOVEA.L	D5,A0
	ADDA.L	#lbL021164,A0
	MOVEA.L	8(A6),A1
	MOVE.W	$18(A1),D0
	MOVE.L	A0,$10(SP)
	TST.W	D0
	BMI.S	lbC02081A
	CMPI.W	#$140,D0
	BGE.S	lbC02081A
	MOVEQ	#1,D0
	BRA.S	lbC02081C

lbC02081A	MOVEQ	#0,D0
lbC02081C	MOVEA.L	$10(SP),A0
	MOVE.B	D0,(A0)
	TST.B	D0
	BEQ.S	lbC02082E
	MOVE.L	D5,-(SP)
	BSR.L	lbC0204E2
	ADDQ.L	#4,SP
lbC02082E	MOVEQ	#0,D6
lbC020830	MOVE.L	D7,D0
	BTST	#0,D0
	BEQ.L	lbC020900
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021138,A0
	MOVEA.L	8(A6),A1
	MOVE.L	$24(A1),-(SP)
	MOVE.L	(A0),-(SP)
	BSR.L	lbC02070A
	ADDQ.L	#8,SP
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021148,A0
	MOVEA.L	8(A6),A1
	MOVE.L	$28(A1),-(SP)
	MOVE.L	(A0),-(SP)
	BSR.L	lbC02070A
	ADDQ.L	#8,SP
	MOVEA.L	D5,A0
	ADDA.L	#lbL021164,A0
	TST.B	(A0)
	BNE.S	lbC020894
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#1,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FBC,A0
	MOVE.W	#$100,(A0)
lbC020894	MOVEA.L	D6,A0
	ADDA.L	#lbL020FD4,A0
	CLR.B	(A0)
	MOVE.L	D6,D0
	MULS.W	#14,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021490,A0
	MOVEA.L	8(A6),A2
	MOVEA.L	$20(A2),A1
	MOVE.L	A0,$10(SP)
	MOVEA.L	A1,A0
	MOVEA.L	$10(SP),A1
	MOVEQ	#13,D0
lbC0208C0	MOVE.B	(A0)+,(A1)+
	DBRA	D0,lbC0208C0
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021470,A0
	MOVEQ	#1,D1
	MOVE.L	D1,-(SP)
	MOVE.L	(A0),-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	lbC02057A
	LEA	12(SP),SP
	MOVE.L	D6,D0
	MOVE.L	D6,D1
	ASL.L	#2,D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL021480,A0
	CLR.L	-(SP)
	MOVE.L	(A0),-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	lbC02057A
	LEA	12(SP),SP
lbC020900	ADDQ.L	#1,D6
	MOVE.L	D7,D0
	ASR.W	#1,D7
	BNE.L	lbC020830
	MOVEA.L	D5,A0
	ADDA.L	#lbL021010,A0
	MOVE.B	#1,(A0)
	MOVEM.L	(SP)+,D5-D7/A2
	UNLK	A6
	RTS

lbC02091E	LINK.W	A6,#-2
	MOVEA.L	8(A6),A0
	MOVE.L	$14(A0),-(SP)
	BSR.L	lbC02012C
	ADDQ.L	#4,SP
	MOVE.B	D0,-1(A6)
	TST.B	D0
	BPL.S	lbC02093C
	UNLK	A6
	RTS

lbC02093C	MOVE.B	-1(A6),D0
	EXT.W	D0
	EXT.L	D0
	MOVE.L	D0,-(SP)
	BSR.L	lbC02015E
	ADDQ.L	#4,SP
	UNLK	A6
	RTS

lbC020950	LINK.W	A6,#-4
	MOVE.W	#1,lbW0211E4
	CLR.L	-4(A6)
lbC020960	MOVE.L	-4(A6),D0
	CMPI.L	#4,D0
	BGE.S	lbC020986
	MOVEA.L	D0,A0
	ADDA.L	#lbL021010,A0
	TST.B	(A0)
	BEQ.S	lbC020980
	MOVE.L	D0,-(SP)
	BSR.L	lbC02015E
	ADDQ.L	#4,SP
lbC020980	ADDQ.L	#1,-4(A6)
	BRA.S	lbC020960

lbC020986	UNLK	A6
	RTS

lbC02098A	LINK.W	A6,#0
	MOVEA.L	8(A6),A0
	MOVE.B	$1A(A0),D0
	EXT.W	D0
	EXT.L	D0
	SUBI.L	#1,D0
	BLT.S	lbC020A12
	CMPI.L	#6,D0
	BGE.S	lbC020A12
	ASL.L	#1,D0
	JMP	lbC0209B0(PC,D0.L)
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
lbC0209B0	BRA.S	lbC0209BC

	BRA.S	lbC0209C8

	BRA.S	lbC0209D4

	BRA.S	lbC020A12

	BRA.S	lbC0209E0

	BRA.S	lbC0209EC

lbC0209BC	MOVE.L	8(A6),-(SP)
	BSR.L	lbC02076E
	ADDQ.L	#4,SP
	BRA.S	lbC020A12

lbC0209C8	MOVE.L	8(A6),-(SP)
	BSR.L	lbC02091E
	ADDQ.L	#4,SP
	BRA.S	lbC020A12

lbC0209D4	MOVE.L	8(A6),-(SP)
	BSR.L	lbC0206B8
	ADDQ.L	#4,SP
	BRA.S	lbC020A12

lbC0209E0	MOVE.L	8(A6),-(SP)
	BSR.L	lbC020950
	ADDQ.L	#4,SP
	BRA.S	lbC020A12

lbC0209EC	MOVEA.L	8(A6),A0
	MOVE.B	$1B(A0),D0
	EXT.W	D0
	EXT.L	D0
	MOVE.W	$18(A0),D1
	EXT.L	D1
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	BSR.L	lbC0203D6
	ADDQ.L	#8,SP
	MOVEA.L	8(A6),A0
	MOVE.W	D0,$1C(A0)
	NOP
lbC020A12	MOVEA.L	8(A6),A0
	TST.L	14(A0)
	BEQ.S	lbC020A28
	MOVE.L	A0,-(SP)
	JSR	_ReplyMsg
	ADDQ.L	#4,SP
	BRA.S	lbC020A38

lbC020A28	MOVEQ	#$34,D0
	MOVE.L	D0,-(SP)
	MOVE.L	8(A6),-(SP)
	JSR	_FreeMem
	ADDQ.L	#8,SP
lbC020A38	UNLK	A6
	RTS

runTask1_SFX	
	LINK.W	A6,#-$2C
	MOVEM.L	D6/D7/A5,-(SP)
	PEA	-$2C(A6)
	BSR.L	MakePort
	ADDQ.L	#4,SP
	LEA	-$2C(A6),A0
	MOVE.L	A0,messagePort1
	BSR.L	lbC01FF34_openADetc
	MOVEQ	#$28,D0
	MOVE.L	D0,-(SP)
	PEA	timer
	JSR	_Zero
	ADDQ.L	#8,SP
	CLR.L	-(SP)
	PEA	timer
	MOVEQ	#1,D0
	MOVE.L	D0,-(SP)
	PEA	timerdevice.MSG
	JSR	_OpenDevice
	
	LEA	$10(SP),SP
	MOVE.L	messagePort1,timer_msgPort
	
	CLR.L	timer_secs
	MOVE.L	#$411A,timer_micros	>>>> 60Hz timer
	MOVE.W	#9,timer_cmdFlags			>>>> TR_ADDREQUEST
	
	PEA	timer
	JSR	_BeginIO
	ADDQ.L	#4,SP
	
task1_loop	
	MOVE.L	messagePort1,-(SP)
	JSR	_WaitPort			>>>>>>>>> wait for message
	ADDQ.L	#4,SP
	
	MOVE.L	messagePort1,-(SP)
	JSR	_GetMsg						>>>>>>>>>> XXX check if this ever gets here to retrieve message..
	ADDQ.L	#4,SP
	
	MOVE.L	D0,D7
	LEA	timer,A0
	CMP.L	A0,D7				=> XXXX how does the timer get put here as a message?
	BNE.S	lbC020B22			****** 2 types of messages.. 
	
	
		case 1) a timer message.. 
	
	CLR.L	timer_secs
	MOVE.L	#$411A,timer_micros		>>>>>>>> reset timer.. this should probably not re-start
									until below BeginIO is called...
	MOVE.W	#9,timer_cmdFlags
	
	TST.W	lbW0211E4	=> what is this testing?
	BEQ.S	lbC020B0C
	
	MOVE.W	#1,lbW0211E6
	BRA.S	task1_loop

lbC020B0C	
	PEA	timer
	JSR	_BeginIO
	ADDQ.L	#4,SP
	
	JSR	lbC021740
	BRA.S	task1_loop
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
lbC020B22
		
		case 2) message from other task (not from timer..)

	LEA	lbL021250,A0
	CMP.L	A0,D7
	BCS.S	lbC020B86
	LEA	lbL02142C,A0
	CMP.L	A0,D7
	BHI.S	lbC020B86
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< additional	
	
	LEA	lbL021250,A5
	MOVEQ	#0,D6
lbC020B3E	MOVE.L	A5,D0
	MOVE.L	A5,D1
	CMP.L	D1,D7
	BNE.S	lbC020B76
	MOVE.L	D6,D1
	EXT.W	D1
	EXT.L	D1
	MOVEA.L	D1,A0
	ADDA.L	#lbL020FD8,A0
	MOVE.B	(A0),D1
	BTST	#2,D1
	BNE.L	task1_loop
	MOVE.L	D6,D0
	EXT.W	D0
	EXT.L	D0
	CLR.L	-(SP)	<<<<<<<<<<<<<<<<<<<		additional
	MOVE.L	A5,-(SP) <<<<<<<<<<<<<<<<<
	MOVE.L	D0,-(SP)
	BSR.L	lbC02057A
	LEA	12(SP),SP
	BRA.L	task1_loop

lbC020B76	ADDA.W	#$44,A5
	ADDQ.B	#1,D6
	MOVE.L	D6,D0
	ANDI.B	#3,D0
	MOVE.L	D0,D6
	BRA.S	lbC020B3E
lbC020B86	MOVEA.L	D7,A0
	MOVE.L	A0,-(SP)
	BSR.L	lbC02098A
	ADDQ.L	#4,SP
	BRA.L	task1_loop
	
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

InitSfx	LINK.W	A6,#-6
	MOVE.W	#1,lbW0211E8
	MOVEQ	#0,D0
	MOVE.L	#$208,-(SP)
	PEA	lbL0214D6
	MOVE.W	D0,lbW0211E4
	MOVE.W	D0,lbW0211E6
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$5C,D0
	MOVE.L	D0,-(SP)
	PEA	lbL021170
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#$38,D0
	MOVE.L	D0,-(SP)
	PEA	lbL021490
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#8,D0
	MOVE.L	D0,-(SP)
	PEA	lbL021004
	JSR	_Zero
	ADDQ.L	#8,SP
	MOVEQ	#4,D0
	MOVE.L	D0,-(SP)
	PEA	lbL021010
	JSR	_Zero
	ADDQ.L	#8,SP
	CLR.B	-1(A6)
lbC020C0E	MOVE.B	-1(A6),D0
	CMPI.B	#4,D0
	BGE.S	lbC020C50
	
	EXT.W	D0
	EXT.L	D0
	MOVE.L	D0,0(SP)
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL020FEC,A0
	MOVE.W	#1,(A0)
	
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL02100C,A0
	MOVE.B	#1,(A0)
	MOVEA.L	0(SP),A0
	ADDA.L	#lbL020FD8,A0
	MOVE.B	#$FF,(A0)
	ADDQ.B	#1,-1(A6)
	BRA.S	lbC020C0E

lbC020C50	MOVE.L	#lbL0214D6,lbL0211AA
	LEA	lbW0216DC,A0
	MOVE.L	A0,lbL0211AE
	MOVE.L	A0,lbL0211A6
	MOVE.B	#1,lbB021178
	MOVE.L	lbL020FA4,D0		>>>> prio?
	MOVE.B	D0,lbB021179
	MOVE.L	#SfxTask.MSG,lbL02117A
	LEA	lbL021170,A0
	CLR.L	-(SP)
	PEA	runTask1_SFX(PC)
	MOVE.L	A0,-(SP)
	MOVE.L	A0,lbL02116C
	JSR	_AddTask
	LEA	12(SP),SP
	UNLK	A6
	RTS

	
ResetSfx	
	LINK.W	A6,#-$5A
	MOVE.W	#1,lbW0211E4
	LEA	-$34(A6),A0
	PEA	-$5A(A6)
	MOVE.L	A0,-$38(A6)
	BSR.L	MakePort
	ADDQ.L	#4,SP
	MOVEQ	#$34,D0
	MOVE.L	D0,-(SP)
	MOVE.L	-$38(A6),-(SP)
	JSR	_Zero
	ADDQ.L	#8,SP
	LEA	-$5A(A6),A0
	MOVEA.L	-$38(A6),A1
	MOVE.L	A0,14(A1)
	MOVEQ	#-1,D0
	MOVE.L	D0,$14(A1)
	MOVE.B	#5,$1A(A1)
	MOVE.L	A1,-(SP)
	MOVE.L	messagePort1,-(SP)
	JSR	_PutMsg
	ADDQ.L	#8,SP
	PEA	-$5A(A6)
	
	JSR	_WaitPort
	ADDQ.L	#4,SP
	
	MOVEQ	#15,D0
	MOVE.L	D0,lbL021224
	PEA	AudioIO_request
	JSR	_CloseDevice
	ADDQ.L	#4,SP
lbC020D24	
	TST.W	lbW0211E6
	BEQ.S	lbC020D24
	
	PEA	timer
	JSR	_CloseDevice
	
	ADDQ.L	#4,SP
	MOVEA.L	-$38(A6),A0
	CLR.B	$1A(A0)
	MOVE.L	A0,-(SP)
	MOVE.L	messagePort1,-(SP)
	JSR	_PutMsg
	ADDQ.L	#8,SP
	PEA	-$5A(A6)
	JSR	_WaitPort
	ADDQ.L	#4,SP
	PEA	-$5A(A6)
	JSR	_GetMsg
	ADDQ.L	#4,SP
	PEA	-$5A(A6)
	MOVE.L	D0,-$38(A6)
	BSR.L	UnmakePort
	ADDQ.L	#4,SP
	MOVE.L	messagePort1,-(SP)
	BSR.L	UnmakePort
	ADDQ.L	#4,SP
	PEA	lbL021170
	JSR	_RemTask
	ADDQ.L	#4,SP
	UNLK	A6
	RTS

StartSfx	LINK.W	A6,#-$5E
	TST.W	lbW0211E8
	BNE.S	lbC020DA8
	MOVEQ	#-1,D0
	UNLK	A6
	RTS

lbC020DA8	LEA	-$38(A6),A0
	PEA	-$5E(A6)
	MOVE.L	A0,-$3C(A6)
	BSR.L	MakePort
	ADDQ.L	#4,SP
	MOVEQ	#$14,D0
	MOVE.L	D0,-(SP)
	MOVE.L	-$3C(A6),-(SP)
	JSR	_Zero
	ADDQ.L	#8,SP
	LEA	-$5E(A6),A0
	MOVEA.L	-$3C(A6),A1
	MOVE.L	A0,14(A1)
	MOVEQ	#-1,D0
	MOVE.L	D0,-4(A6)
	MOVE.B	#6,$1A(A1)
	MOVE.B	$1B(A6),$1B(A1)
	MOVE.W	$1E(A6),$18(A1)
	MOVE.L	A1,-(SP)
	MOVE.L	messagePort1,-(SP)
	JSR	_PutMsg
	
	ADDQ.L	#8,SP
	PEA	-$5E(A6)
	JSR	_WaitPort
	ADDQ.L	#4,SP
	PEA	-$5E(A6)
	JSR	_GetMsg
	ADDQ.L	#4,SP
	MOVEA.L	D0,A0
	MOVE.W	$1C(A0),D1
	MOVE.L	D0,-$3C(A6)
	TST.W	D1
	BEQ.S	lbC020E7A
	MOVEA.L	-$3C(A6),A0
	MOVE.L	8(A6),$20(A0)
	MOVE.L	12(A6),$24(A0)
	MOVE.L	$10(A6),$28(A0)
	MOVE.W	$16(A6),$1E(A0)
	MOVE.B	#1,$1A(A0)
	MOVE.L	A0,-(SP)
	MOVE.L	messagePort1,-(SP)
	JSR	_PutMsg
	
	ADDQ.L	#8,SP
	PEA	-$5E(A6)
	JSR	_WaitPort
	ADDQ.L	#4,SP
	PEA	-$5E(A6)
	JSR	_GetMsg
	ADDQ.L	#4,SP
	MOVEA.L	D0,A0
	MOVE.L	$14(A0),-4(A6)
	MOVE.L	D0,-$3C(A6)
lbC020E7A	PEA	-$5E(A6)
	BSR.L	UnmakePort
	ADDQ.L	#4,SP
	MOVE.L	-4(A6),D0
	UNLK	A6
	RTS

;	LINK.W	A6,#-4
;	MOVE.L	#$10001,-(SP)
;	MOVEQ	#$34,D0
;	MOVE.L	D0,-(SP)
;	JSR	_AllocMem
;	ADDQ.L	#8,SP
;	MOVEA.L	D0,A0
;	MOVE.L	8(A6),$14(A0)
;	MOVE.W	14(A6),$18(A0)
;	MOVE.B	#3,$1A(A0)
;	MOVE.L	D0,-(SP)
;	MOVE.L	messagePort1,-(SP)
;	MOVE.L	D0,-4(A6)
;	JSR	_PutMsg
;	ADDQ.L	#8,SP
;	UNLK	A6
;	RTS

lbC020ECE_PutMsg	
	LINK.W	A6,#-4			>>>>>>>>>>> added.. conditional logic
	MOVE.L	8(A6),-(SP)
	BSR.L	lbC02012C		
	ADDQ.L	#4,SP
	TST.B	D0
	BPL.S	SfxEnumIOAudio_PutMsg
	UNLK	A6
	RTS

SfxEnumIOAudio_PutMsg	
	MOVE.L	#$10001,-(SP)		=> mem type?
	MOVEQ	#$34,D0				=> 52 bytes message.. (std message is 20 bytes..)
	MOVE.L	D0,-(SP)
	JSR	_AllocMem
	ADDQ.L	#8,SP
	
	MOVEA.L	D0,A0				=> message
	MOVE.L	8(A6),$14(A0)		=> data set in extended part of msg-struct 
								=> XXX this message has no port set!
	
	MOVE.B	#2,$1A(A0)
	MOVE.L	D0,-(SP)
	MOVE.L	messagePort1,-(SP)		=> this is the port
	MOVE.L	D0,-4(A6)
	
	>>>>>>>>>>>>>>>>>>>>>>>>>> XXX check if this put is getting triggered.. who is the receiver of
	this message? the Task1?
	
	JSR	_PutMsg
	ADDQ.L	#8,SP
	UNLK	A6
	RTS

;	LINK.W	A6,#-6
;	MOVEM.L	D7,-(SP)
;	CLR.W	-6(A6)
;	MOVE.L	8(A6),-(SP)
;	BSR.L	lbC02012C
;	ADDQ.L	#4,SP
;	MOVE.B	D0,-3(A6)
;	TST.B	D0
;	BPL.S	lbC020F44
;	MOVEQ	#0,D0
;	MOVEM.L	(SP)+,D7
;	UNLK	A6
;	RTS

;lbC020F44	MOVE.B	-3(A6),D0
;	EXT.W	D0
;	EXT.L	D0
;	ASL.L	#1,D0
;	MOVEA.L	D0,A0
;	ADDA.L	#lbL021004,A0
;	MOVE.W	(A0),D7
;lbC020F58	MOVE.L	D7,D0
;	BTST	#0,D0
;	BEQ.S	lbC020F7C
;	MOVE.W	-6(A6),D0
;	EXT.L	D0
;	MOVEA.L	D0,A0
;	ADDA.L	#lbL021010,A0
;	TST.B	(A0)
;	BEQ.S	lbC020F7C
;	MOVEQ	#1,D0
;	MOVEM.L	(SP)+,D7
;	UNLK	A6
;	RTS

;lbC020F7C	ADDQ.W	#1,-6(A6)
;	MOVE.L	D7,D0
;	ASR.W	#1,D7
;	BNE.S	lbC020F58
;	MOVEQ	#0,D0
;	MOVEM.L	(SP)+,D7
;	UNLK	A6
;	RTS

;	CLR.W	lbW0211E8
;	RTS

;	MOVE.W	#1,lbW0211E8
;	RTS

;	dc.w	0

;	SECTION	MarbleMadness020FA4,DATA
lbL020FA4	dc.l	7

>>>>>>>>>>>>>>>> this message port is shared by audio-device and timer-device!
messagePort1	dc.l	0

lbL020FAC	dc.l	0
	dc.l	0
lbL020FB4	dc.l	0
	dc.l	0
lbL020FBC	dc.l	0
	dc.l	0
lbL020FC4	dc.l	0
	dc.l	0
lbL020FCC	dc.l	0
	dc.l	0
lbL020FD4	dc.l	0
lbL020FD8	dc.l	0
lbW020FDC	dc.w	2
	dc.w	4
lbW020FE0	dc.w	1
	dc.w	8
lbW020FE4	dc.w	3
	dc.w	5
	dc.w	10
	dc.w	12
lbL020FEC	dc.l	0
	dc.l	0
lbL020FF4	dc.l	0
	dc.l	0
lbL020FFC	dc.l	0
	dc.l	0
lbL021004	dc.l	0
	dc.l	0
lbL02100C	dc.l	0
lbL021010	dc.l	0
lbL021014	dc.l	0
lbL021018	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL0210A8	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL021138	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL021148	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbW021158	dc.w	1
	dc.w	0
	dc.w	1
	dc.w	0
	dc.w	0
	dc.w	0
lbL021164	dc.l	0
	dc.l	0
lbL02116C	dc.l	0
lbL021170	dc.l	0
	dc.l	0
lbB021178	dc.b	0
lbB021179	dc.b	0
lbL02117A	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
lbL0211A6	dc.l	0
lbL0211AA	dc.l	0
lbL0211AE	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.w	0
lbL0211CC	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	0
	dc.l	lbL0211CC
lbW0211E4	dc.w	0
lbW0211E6	dc.w	0
lbW0211E8	dc.w	1
audiodevice.MSG	dc.b	'audio.device',0
timerdevice.MSG	dc.b	'timer.device',0
SfxTask.MSG	dc.b	'SfxTask',0

;	SECTION	MarbleMadness02120C,BSS
AudioIO_request	ds.l	3
	ds.w	1
audioio_msgPort	ds.l	2
	ds.w	1
lbL021224	ds.l	11
lbL021250	ds.l	$44
lbL021360	ds.l	$33
lbL02142C	ds.l	$11
lbL021470	ds.l	4
lbL021480	ds.l	4
lbL021490	ds.l	14
some_list
	ds.l	3
	ds.w	1
	
lbL0214D6	ds.l	$81
	ds.w	1
lbW0216DC	ds.w	1

------------------------------------------------------
timer	
	ds.l	3		=> list node data
	ds.w	1
	
	
timer_msgPort	
	ds.l	3			=> MESSAGE port	
	ds.w	1							=> up to DEVICE/UNIT	
	
	
timer_cmdFlags		=> word 9 is written here
	ds.w	2	=> command+flags

timer_secs	ds.l	1		TV_SECS
timer_micros	ds.l	1		=> TV_MICRO
	ds.w	1				padding?


;	SECTION	MarbleMadness021708,CODE
lbC021708	MOVE.L	4(SP),D0
	ASL.L	#1,D0
	MOVE.L	D0,D1
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021148,A0
	MOVEA.L	(A0),A1
	MOVEA.L	#lbL020FAC,A0
	ADDA.L	D1,A0
	CMPI.L	#$10000,14(A1)
	BNE.S	lbC021734
	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	RTS

lbC021734	MOVE.L	14(A1),D0
	ASR.L	#8,D0
	MULU.W	(A0),D0
	LSR.L	#8,D0
	RTS

lbC021740	LINK.W	A6,#-$56
	MOVEM.L	D2/D4-D7/A5,-(SP)
	MOVEQ	#0,D7
	PEA	some_list
	JSR	lbC021954
	
	ADDQ.L	#4,SP
lbC021758	MOVEA.L	#lbL021010,A0
	ADDA.L	D7,A0
	TST.B	(A0)
	BEQ.L	lbC02183E
	MOVE.L	D7,D0
	ASL.L	#1,D0
	MOVEA.L	#lbL020FFC,A0
	ADDA.L	D0,A0
	TST.W	(A0)
	BNE.S	lbC021784
	MOVE.L	D7,-(SP)
	JSR	lbC02015E
	ADDQ.L	#4,SP
	BRA.L	lbC02183E

lbC021784	MOVEA.L	#lbL021004,A0
	ADDA.L	D0,A0
	MOVE.W	(A0),D6
	MOVEQ	#0,D5
	MOVEA.L	#lbL021250,A5
lbC021796	BTST	#0,D6
	BEQ.L	lbC021824
	MOVE.L	D5,-(SP)
	BSR.L	lbC021708
	MOVE.L	D0,D4
	MOVE.L	D5,-(SP)
	BSR.L	lbC021850
	ADDQ.L	#8,SP
	MOVE.L	D5,D2
	ASL.L	#1,D2
	MOVEA.L	#lbL020FC4,A0
	ADDA.L	D2,A0
	MOVE.W	D0,-14(A6)
	CMP.W	(A0),D0
	BNE.S	lbC0217CE
	MOVEA.L	#lbL020FCC,A0
	ADDA.L	D2,A0
	CMP.W	(A0),D4
	BEQ.S	lbC021824
lbC0217CE	MOVEQ	#$2C,D0
	MOVE.L	D0,-(SP)
	PEA	-$52(A6)
	MOVE.L	A5,-(SP)
	JSR	_Copy
	LEA	12(SP),SP
	MOVE.L	D4,D1
	CMPI.W	#$72,D4
	BCC.S	lbC0217EC
	MOVEQ	#$48,D1
lbC0217EC	MOVE.W	D1,-$28(A6)
	MOVEA.L	#lbL020FCC,A0
	ADDA.L	D2,A0
	MOVE.W	D1,(A0)
	MOVEA.L	#lbL020FC4,A0
	ADDA.L	D2,A0
	MOVE.W	-14(A6),D1
	MOVE.W	D1,-$26(A6)
	MOVE.W	D1,(A0)
	MOVE.W	#12,-$36(A6)
	MOVE.B	#1,-$34(A6)
	PEA	-$52(A6)
	JSR	_BeginIO
	ADDQ.L	#4,SP
lbC021824	ADDA.W	#$44,A5
	ADDQ.W	#1,D5
	ASR.W	#1,D6
	BNE.L	lbC021796
	MOVE.L	D7,D1
	ASL.L	#1,D1
	MOVEA.L	#lbL020FFC,A0
	ADDA.L	D1,A0
	SUBQ.W	#1,(A0)
lbC02183E	ADDQ.W	#1,D7
	CMPI.W	#4,D7
	BLT.L	lbC021758
	MOVEM.L	(SP)+,D2/D4-D7/A5
	UNLK	A6
	RTS

lbC021850	MOVE.L	D2,-(SP)
	MOVE.W	10(SP),D0
	EXT.L	D0
	ASL.L	#1,D0
	MOVE.L	D0,D2
	ASL.L	#1,D0
	MOVEA.L	D0,A0
	ADDA.L	#lbL021138,A0
	MOVEA.L	(A0),A1
	MOVE.L	14(A1),D0
	LSR.L	#8,D0
	MOVEA.L	#lbL020FBC,A0
	ADDA.L	D2,A0
	MOVE.W	(A0),D1
	CMPI.L	#$100,D0
	BNE.S	lbC02189E
	MOVEA.L	#lbL020FB4,A0
	ADDA.L	D2,A0
	CMPI.W	#$100,D1
	BNE.S	lbC021896
	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	MOVE.L	(SP)+,D2
	RTS

lbC021896	MOVE.W	(A0),D0
	MULU.W	D1,D0
	LSR.L	#8,D0
	BRA.S	lbC0218C2

lbC02189E	MOVE.L	D0,10(SP)
	MOVEA.L	#lbL020FB4,A0
	ADDA.L	D2,A0
	CMPI.W	#$100,D1
	BNE.S	lbC0218B6
	MOVEQ	#0,D0
	MOVE.W	(A0),D0
	BRA.S	lbC0218BC

lbC0218B6	MOVE.W	(A0),D0
	MULU.W	D1,D0
	LSR.L	#8,D0
lbC0218BC	MULU.W	12(SP),D0
	LSR.L	#8,D0
lbC0218C2	MOVE.L	(SP)+,D2
	RTS

;	dc.w	0


;	SECTION	MarbleMadness0218C8,CODE
_Zero	MOVEA.L	4(SP),A0
	MOVE.L	8(SP),D0
	CLR.L	D1
	BTST	#0,D0
	BNE.S	lbC0218FE
	BTST	#0,7(SP)
	BNE.S	lbC0218FE
	BTST	#1,D0
	BEQ.S	lbC0218F2
	ASR.L	#1,D0
	SUBQ.L	#1,D0
lbC0218EA	MOVE.W	D1,(A0)+
	DBRA	D0,lbC0218EA
	RTS

lbC0218F2	ASR.L	#2,D0
	SUBQ.L	#1,D0
lbC0218F6	MOVE.L	D1,(A0)+
	DBRA	D0,lbC0218F6
	RTS

lbC0218FE	SUBQ.L	#1,D0
lbC021900	MOVE.B	D1,(A0)+
	DBRA	D0,lbC021900
	RTS

_Copy	MOVEA.L	4(SP),A0
	MOVEA.L	8(SP),A1
	MOVE.L	12(SP),D0
	BTST	#0,D0
	BNE.S	lbC021948
	BTST	#0,7(SP)
	BNE.S	lbC021948
	BTST	#0,11(SP)
	BNE.S	lbC021948
	BTST	#1,D0
	BEQ.S	lbC02193C
	ASR.L	#1,D0
	SUBQ.L	#1,D0
lbC021934	MOVE.W	(A0)+,(A1)+
	DBRA	D0,lbC021934
	RTS

lbC02193C	ASR.L	#2,D0
	SUBQ.L	#1,D0
lbC021940	MOVE.L	(A0)+,(A1)+
	DBRA	D0,lbC021940
	RTS

lbC021948	SUBQ.L	#1,D0
lbC02194A	MOVE.B	(A0)+,(A1)+
	DBRA	D0,lbC02194A
	RTS

;	dc.w	0


;	SECTION	MarbleMadness021954,CODE
lbC021954	
	MOVEA.L	4(SP),A1
	MOVEM.L	A5/A6,-(SP)
	JSR	lbC021968
	MOVEM.L	(SP)+,A5/A6
	RTS

lbC021968	MOVEA.L	0(A1),A0
	BRA.S	lbC021974

lbC02196E	RTS

lbC021970	MOVEA.L	0(A0),A0
lbC021974	TST.L	(A0)
	BEQ.S	lbC02196E
	MOVEA.L	$16(A0),A1
	MOVE.L	0(A1),D0
	BEQ.S	lbC021970
	BGE.S	lbC021992
	ADD.L	14(A0),D0
	BVS.S	lbC0219B0
	CMP.L	4(A1),D0
	BGT.S	lbC02199E
	BRA.S	lbC0219BE

lbC021992	ADD.L	14(A0),D0
	BVS.S	lbC0219D0
	CMP.L	4(A1),D0
	BGE.S	lbC0219DE
lbC02199E	MOVE.L	D0,14(A0)

lbC0219A2	
	MOVE.L	$12(A0),D1
	BEQ.S	lbC021970
	SWAP	D0
	MOVEA.L	D1,A1
	MOVE.W	D0,(A1)
	BRA.S	lbC021970

lbC0219B0	
	MOVE.L	#$80000000,D0
	BRA.S	lbC0219BE

lbC0219B8	CMP.L	4(A1),D0
	BGT.S	lbC0219F2
lbC0219BE	
	MOVEQ	#8,D1
	ADD.L	D1,$16(A0)
	MOVEA.L	$16(A0),A1
	MOVE.L	0(A1),D1
	BLT.S	lbC0219B8
	BRA.S	lbC0219EE

lbC0219D0	
	MOVE.L	#$7FFFFFFF,D0
	BRA.S	lbC0219DE

lbC0219D8	CMP.L	4(A1),D0
	BLT.S	lbC0219F2
lbC0219DE	MOVEQ	#8,D1
	ADD.L	D1,$16(A0)
	MOVEA.L	$16(A0),A1
	MOVE.L	0(A1),D1
	BGT.S	lbC0219D8
lbC0219EE	MOVE.L	-4(A1),D0
lbC0219F2	MOVE.L	D0,14(A0)
	TST.L	D1
	BNE.S	lbC0219A2
	MOVE.L	$1A(A0),D1
	BEQ.S	lbC021A04
	MOVE.L	D1,$16(A0)
lbC021A04	MOVE.L	$1E(A0),D1
	BEQ.S	lbC0219A2			=>>> WTF is this for?
	BRA.L	lbC0219A2

;	dc.w	0

;LoadSeg
;	SECTION	MarbleMadness021A10,CODE
;lbC021A10	MOVE.B	lbB021DD1,D0
;	MOVE.B	D0,lbB021DD0
;	TST.B	D0
;	BEQ.S	lbC021A4C
;	MOVE.W	lbW0005D6,D0			; song number
;	EXT.L	D0
;	ASL.L	#2,D0
;	MOVEA.L	D0,A0
;	ADDA.L	#lbL021E02,A0
;	MOVE.L	(A0),-(SP)
;	JSR	lbC008CF0
;	ADDQ.L	#4,SP
;	MOVE.L	D0,songPtr
;	TST.L	D0
;	BNE.S	lbC021A4C
;	CLR.B	lbB021DD0
;lbC021A4C	RTS

;lbC021A4E	LINK.W	A6,#-10
;	TST.L	songPtr
;	BEQ.S	lbC021AA6
;	MOVEA.L	songPtr,A0
;	MOVE.W	(A0),-2(A6)
;	ADDQ.L	#2,A0
;	MOVE.L	A0,-6(A6)
;lbC021A6A	MOVEA.L	-6(A6),A0
;	MOVE.W	(A0),D0
;	SUBQ.W	#3,D0
;	BNE.S	lbC021A92
;	MOVE.L	4(A0),D0
;	MOVE.L	D0,-10(A6)
;	TST.L	D0
;	BEQ.S	lbC021A8A
;	MOVE.L	D0,-(SP)
;	JSR	lbC020ECE_PutMsg
;	ADDQ.L	#4,SP
;lbC021A8A	MOVEA.L	-6(A6),A0
;	CLR.W	2(A0)
;lbC021A92	SUBQ.W	#1,-2(A6)
;	CMPI.W	#0,-2(A6)
;	BHI.S	lbC021A6A
;	BSR.L	lbC021DB2
;	BSR.L	lbC021D9C
;lbC021AA6	UNLK	A6
;	RTS

;UnloadSeg
;lbC021AAA	TST.L	songPtr
;	BEQ.S	lbC021AD6
;	TST.B	lbB021DD0
;	BEQ.S	lbC021AC2
;	JSR	lbC01F392
;	BSR.S	lbC021A4E
;lbC021AC2	MOVE.L	songPtr,-(SP)
;	JSR	lbC008D24
;	ADDQ.L	#4,SP
;	CLR.L	songPtr
;lbC021AD6	RTS

;	MOVEQ	#-1,D0
;	RTS

InitMusic  >>>>>>>>>>> select track
lbC021ADC
	
	>>>> alloc 18 bytes on stack; a6 then points to end of that stackframe
	LINK.W	A6,#-$12
	
	MOVEM.L	D2,-(SP)	> just another saved reg
	
	MOVEA.L	songPtr,A0
	ADDQ.L	#2,A0			=> skio 1st word (song offset)
	MOVE.L	A0,-4(A6)		=> start of songdata
	TST.B	lbB021DD0
	BNE.S	lbC021B00
	
	MOVEM.L	(SP)+,D2
	UNLK	A6
	RTS

lbC021B00	MOVEQ	#0,D0
	MOVEA.L	songPtr,A0
	MOVE.W	(A0),D0
	MOVE.L	8(A6),D1		>> put there by InitSound Song-"Offset", e.g. 25
	CMP.L	D0,D1
	BCS.S	lbC021B1A
	MOVEM.L	(SP)+,D2
	UNLK	A6
	RTS

lbC021B1A	MOVE.L	8(A6),D0		; e.g. 25
	ASL.L	#3,D0					; *8	=> 200
	ADD.L	D0,-4(A6)				; start of track within songdata
	MOVEQ	#0,D0
	MOVEA.L	-4(A6),A0
	MOVE.W	(A0),D0					; some track id validation?
	CMPI.L	#6,D0
	BCC.L	end_track_select
	ASL.L	#2,D0					: *4 (4 bytes per BRA.L)
	JMP	lbC021B3C(PC,D0.L)

	
	>>>>>>>>> switch of 6 cases..
lbC021B3C	BRA.L	initTrack0

	BRA.L	lbC021B8C

	BRA.L	lbC021C80

	BRA.L	lbC021C88

	BRA.L	lbC021CB6		> unused

	BRA.L	lbC021CC0		> unused

initTrack0	
	MOVEA.L	-4(A6),A1		>> buffer songdata?
	MOVEA.L	4(A1),A0
	MOVE.L	A0,-8(A6)
	CMPA.L	#0,A0
	BEQ.L	end_track_select
	MOVE.L	A0,-(SP)
	BSR.L	lbC021D1E
	ADDQ.L	#4,SP
	CLR.L	-(SP)
	MOVEQ	#$63,D0
	MOVE.L	D0,-(SP)
	MOVEA.L	-8(A6),A0
	MOVE.L	(A0),-(SP)
	JSR	lbC01F6D0
	LEA	12(SP),SP
	BRA.L	end_track_select

lbC021B8C	MOVEA.L	-4(A6),A1
	MOVEA.L	4(A1),A0
	MOVE.L	A0,-8(A6)
	CMPA.L	#0,A0
	BEQ.L	end_track_select
	MOVE.W	$10(A0),-14(A6)
	TST.B	15(A6)
	BNE.S	lbC021BB6
	MOVE.W	#$FFFF,-14(A6)
	BRA.S	lbC021BC4

lbC021BB6	CMPI.B	#1,15(A6)
	BNE.S	lbC021BC4
	MOVE.W	#$FFFE,-14(A6)
lbC021BC4	MOVEA.L	-4(A6),A0
	MOVE.W	2(A0),D0
	ADDQ.W	#1,D0
	BNE.S	lbC021C0A
	MOVEQ	#0,D0
	MOVEA.L	-8(A6),A0
	MOVE.W	12(A0),D0
	MOVE.B	14(A0),D1
	EXT.W	D1
	EXT.L	D1
	MOVE.W	-14(A6),D2
	EXT.L	D2
	MOVE.L	D2,-(SP)
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	MOVE.L	8(A0),-(SP)
	MOVE.L	4(A0),-(SP)
	MOVE.L	(A0),-(SP)
	JSR	StartSfx
	LEA	$18(SP),SP
	MOVE.L	D0,-12(A6)
	BRA.L	end_track_select

lbC021C0A	
	MOVEA.L	songPtr,A0
	ADDQ.L	#2,A0
	MOVEA.L	-4(A6),A1
	MOVE.W	2(A1),D0
	EXT.L	D0
	ASL.L	#3,D0
	ADDA.L	D0,A0
	MOVE.L	4(A0),D0
	MOVE.L	D0,-12(A6)
	MOVE.L	A0,-$12(A6)
	TST.L	D0
	BEQ.S	lbC021C3A
	MOVE.L	D0,-(SP)
	JSR	lbC020ECE_PutMsg
	ADDQ.L	#4,SP
lbC021C3A	MOVEQ	#0,D0
	MOVEA.L	-8(A6),A0
	MOVE.W	12(A0),D0
	MOVE.B	14(A0),D1
	EXT.W	D1
	EXT.L	D1
	MOVE.W	-14(A6),D2
	EXT.L	D2
	MOVE.L	D2,-(SP)
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	MOVE.L	8(A0),-(SP)
	MOVE.L	4(A0),-(SP)
	MOVE.L	(A0),-(SP)
	JSR	StartSfx
	LEA	$18(SP),SP
	MOVEA.L	-$12(A6),A0
	MOVE.L	D0,4(A0)
	MOVE.W	2(A0),D0
	ADDQ.W	#1,D0
	MOVE.W	D0,2(A0)
	BRA.S	end_track_select

lbC021C80	JSR	lbC01F392
	BRA.S	end_track_select

lbC021C88	
	MOVEA.L	-4(A6),A0
	MOVE.W	2(A0),D0
	TST.W	D0
	BLE.S	end_track_select
	SUBQ.W	#1,D0
	MOVE.W	D0,2(A0)
	TST.W	D0
	BNE.S	end_track_select
	MOVE.L	4(A0),D0
	MOVE.L	D0,-8(A6)
	TST.L	D0
	BEQ.S	end_track_select
	MOVE.L	D0,-(SP)
	JSR	lbC020ECE_PutMsg
	ADDQ.L	#4,SP
;	BRA.S	end_track_select

lbC021CB6
;	MOVE.B	#1,lbB021DD2
;	BRA.S	end_track_select

lbC021CC0
;	CLR.B	lbB021DD2
;	NOP
end_track_select	MOVEM.L	(SP)+,D2
	UNLK	A6
	RTS

;lbC021CD0	LINK.W	A6,#-2
;	MOVE.W	lbW0006C4,D0
;	MOVE.W	lbW0006C6,D1
;	CMP.W	D1,D0
;	BGE.S	lbC021CE8
;	MOVEQ	#1,D0
;	BRA.S	lbC021CEA

;lbC021CE8	MOVEQ	#0,D0
;lbC021CEA	MOVE.B	D0,-1(A6)
;	EXT.W	D0
;	EXT.L	D0
;	MOVE.L	D0,-(SP)
;	MOVE.L	8(A6),-(SP)
;	BSR.L	lbC021ADC
;	ADDQ.L	#8,SP
;	UNLK	A6
;	RTS

;lbC021D02	MOVEQ	#15,D0
;	MOVE.L	D0,-(SP)
;	BSR.S	lbC021CD0
;	ADDQ.L	#4,SP
;	MOVE.W	lbW0005D6,D0
;	SUBQ.W	#2,D0
;	BEQ.S	lbC021D1C
;	MOVEQ	#$10,D0
;	MOVE.L	D0,-(SP)
;	BSR.S	lbC021CD0
;	ADDQ.L	#4,SP
;lbC021D1C	RTS

lbC021D1E	LINK.W	A6,#-6
	MOVEA.L	8(A6),A0
	MOVE.L	4(A0),-6(A6)
	CLR.B	-1(A6)
	
loop
lbC021D30	MOVE.B	-1(A6),D0
	CMPI.B	#8,D0
	BCC.S	lbC021D82
	MOVEQ	#0,D1
	MOVE.B	-1(A6),D1
	MOVEA.L	-6(A6),A0
	MOVE.L	12(A0),-(SP)
	MOVE.L	8(A0),-(SP)
	MOVE.L	(A0),-(SP)
	MOVE.L	4(A0),-(SP)
	MOVE.L	D1,-(SP)
	JSR	lbC01F782
	LEA	$14(SP),SP
	MOVEQ	#0,D0
	MOVE.B	-1(A6),D0
	MOVEA.L	-6(A6),A0
	MOVE.B	$10(A0),D1
	EXT.W	D1
	EXT.L	D1
	MOVE.L	D1,-(SP)
	MOVE.L	D0,-(SP)
	JSR	lbC01F8DA
	ADDQ.L	#8,SP
	ADDQ.B	#1,-1(A6)
	BRA.S	lbC021D30 -> loop

lbC021D82	MOVEA.L	8(A6),A0
	MOVE.W	8(A0),D0
	EXT.L	D0
	ASL.L	#7,D0
	MOVE.L	D0,-(SP)
	JSR	SetTempo
	ADDQ.L	#4,SP
	UNLK	A6
	RTS

InitPlay
lbC021D9C	TST.B	lbB021DD0
	BEQ.S	lbC021DB0
	JSR	InitSfx
	JSR	Initmus
lbC021DB0	RTS



XXXX fixme check if this gets triggered...

EndPlay
lbC021DB2	TST.B	lbB021DD0
	BEQ.S	lbC021DCC
	JSR	lbC01F392
	JSR	ResetMus
	JSR	ResetSfx
lbC021DCC	RTS

;	dc.w	0

;	SECTION	MarbleMadness021DD0,DATA
lbB021DD0	dc.b	1
lbB021DD1	dc.b	1
lbB021DD2	dc.b	0
	dc.b	0
songPtr	dc.l	Song
;prcsnd.MSG	dc.b	'prcsnd',0
;begsnd.MSG	dc.b	'begsnd',0
;intsnd.MSG	dc.b	'intsnd',0
;aersnd.MSG	dc.b	'aersnd',0
;silsnd.MSG	dc.b	'silsnd',0
;ultsnd.MSG	dc.b	'ultsnd',0
;lbL021E02	dc.l	prcsnd.MSG
;	dc.l	begsnd.MSG
;	dc.l	intsnd.MSG
;	dc.l	aersnd.MSG
;	dc.l	silsnd.MSG
;	dc.l	ultsnd.MSG
;	dc.w	0


;	SECTION	MarbleMadness023E80,CODE
lbC023E80	MOVE.L	D2,-(SP)
	MOVE.L	D3,-(SP)
	TST.L	D1
	BEQ.S	lbC023EAA
	TST.L	D0
	BEQ.S	lbC023EA8
	CLR.L	D2
	MOVEQ	#$1F,D3
lbC023E90	ASL.L	#1,D0
	ROXL.L	#1,D2
	CMP.L	D1,D2
	BCS.S	lbC023EA0
	SUB.L	D1,D2
	ADD.L	#1,D0
lbC023EA0	DBRA	D3,lbC023E90
	MOVE.L	D2,D1
	BRA.S	lbC023EAC

lbC023EA8	CLR.L	D1
lbC023EAA	CLR.L	D0
lbC023EAC	MOVE.L	(SP)+,D3
	MOVE.L	(SP)+,D2
	RTS

;	SECTION	MarbleMadness023EF8,CODE
lbC023EF8	MOVEM.L	D1-D3,-(SP)
	MOVE.L	D0,D2
	BEQ.S	lbC023F20
	TST.L	D1
	BNE.S	lbC023F08
	CLR.L	D0
	BRA.S	lbC023F20

lbC023F08	MOVE.L	D0,D3
	MULU.W	D1,D3
	SWAP	D2
	MULU.W	D1,D2
	SWAP	D2
	CLR.W	D2
	ADD.L	D2,D3
	SWAP	D1
	MULU.W	D1,D0
	SWAP	D0
	CLR.W	D0
	ADD.L	D3,D0
lbC023F20	MOVEM.L	(SP)+,D1-D3
	RTS


;	SECTION	MarbleMadness023F28,CODE
_CX33	MOVEM.L	D1-D4,-(SP)
	MOVE.L	D0,D4
	EOR.L	D1,D4
	TST.L	D0
	BEQ.S	lbC023F64
	BPL.S	lbC023F38
	NEG.L	D0
lbC023F38	MOVE.L	D0,D2
	TST.L	D1
	BNE.S	lbC023F42
	CLR.L	D0
	BRA.S	lbC023F64

lbC023F42	BPL.S	lbC023F46
	NEG.L	D1
lbC023F46	MOVE.L	D0,D3
	MULU.W	D1,D3
	SWAP	D2
	MULU.W	D1,D2
	SWAP	D2
	CLR.W	D2
	ADD.L	D2,D3
	SWAP	D1
	MULU.W	D1,D0
	SWAP	D0
	CLR.W	D0
	ADD.L	D3,D0
	TST.L	D4
	BPL.S	lbC023F64
	NEG.L	D0
lbC023F64	MOVEM.L	(SP)+,D1-D4
	RTS


;_AddIntServer	MOVE.L	A6,-(SP)
;	MOVEA.L	execBase,A6
;	MOVEM.L	8(SP),D0/A1
;	JSR	-$A8(A6)
;	MOVEA.L	(SP)+,A6
;	RTS

;_RemIntServer	MOVE.L	A6,-(SP)
;	MOVEA.L	execBase,A6
;	MOVEM.L	8(SP),D0/A1
;	JSR	-$AE(A6)
;	MOVEA.L	(SP)+,A6
;	RTS

_AllocMem	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEM.L	8(SP),D0/D1
	JSR	-$C6(A6)
	MOVEA.L	(SP)+,A6
	RTS

_FreeMem	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	MOVE.L	12(SP),D0
	JSR	-$D2(A6)
	MOVEA.L	(SP)+,A6
	RTS

_AddHead	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEM.L	8(SP),A0/A1
	JSR	-$F0(A6)
	MOVEA.L	(SP)+,A6
	RTS

_AddTask	MOVEM.L	A2/A3/A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEM.L	$10(SP),A1-A3
	JSR	-$11A(A6)
	MOVEM.L	(SP)+,A2/A3/A6
	RTS

_RemTask	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	JSR	-$120(A6)
	MOVEA.L	(SP)+,A6
	RTS

_FindTask	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	JSR	-$126(A6)
	MOVEA.L	(SP)+,A6
	RTS

_Wait	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVE.L	8(SP),D0
	JSR	-$13E(A6)
	MOVEA.L	(SP)+,A6
	RTS

_Signal	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	MOVE.L	12(SP),D0
	JSR	-$144(A6)
	MOVEA.L	(SP)+,A6
	RTS

_AllocSignal	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVE.L	8(SP),D0
	JSR	-$14A(A6)
	MOVEA.L	(SP)+,A6
	RTS

_FreeSignal	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVE.L	8(SP),D0
	JSR	-$150(A6)
	MOVEA.L	(SP)+,A6
	RTS

_PutMsg	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEM.L	8(SP),A0/A1
	JSR	-$16E(A6)
	MOVEA.L	(SP)+,A6
	RTS

_GetMsg	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A0
	JSR	-$174(A6)
	MOVEA.L	(SP)+,A6
	RTS

_ReplyMsg	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	JSR	-$17A(A6)
	MOVEA.L	(SP)+,A6
	RTS

_WaitPort	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A0
	JSR	-$180(A6)
	MOVEA.L	(SP)+,A6
	RTS

_OpenDevice	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A0
	MOVEM.L	12(SP),D0/A1
	MOVE.L	$14(SP),D1
	JSR	-$1BC(A6)
	MOVEA.L	(SP)+,A6
	RTS

_CloseDevice	MOVE.L	A6,-(SP)
	MOVEA.L	execBase,A6
	MOVEA.L	8(SP),A1
	JSR	-$1C2(A6)
	MOVEA.L	(SP)+,A6
	RTS

;	SECTION	MarbleMadness024A3C,CODE
_BeginIO	MOVEA.L	4(SP),A1
	MOVE.L	A6,-(SP)
	MOVEA.L	$14(A1),A6
	JSR	-$1E(A6)
	MOVEA.L	(SP)+,A6
	RTS

;	SECTION	MarbleMadness024A50,CODE
_NewList	MOVEA.L	4(SP),A0
	MOVE.L	A0,(A0)
	ADDQ.L	#4,(A0)
	CLR.L	4(A0)
	MOVE.L	A0,8(A0)
	RTS

MM_End
